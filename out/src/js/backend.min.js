/**
 * Super simple wysiwyg editor v0.8.8
 * http://summernote.org/
 *
 * summernote.js
 * Copyright 2013- Alan Hong. and other contributors
 * summernote may be freely distributed under the MIT license./
 *
 * Date: 2017-09-09T11:03Z
 */
!function(a){/* global define */
"function"==typeof define&&define.amd?
// AMD. Register as an anonymous module.
define(["jquery"],a):"object"==typeof module&&module.exports?
// Node/CommonJS
module.exports=a(require("jquery")):
// Browser globals
a(window.jQuery)}(function(a){"use strict";var b,c="function"==typeof define&&define.amd,d=function(b){var c="Comic Sans MS"===b?"Courier New":"Comic Sans MS",d=a("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),e=d.css("fontFamily",c).width(),f=d.css("fontFamily",b+","+c).width();return d.remove(),e!==f},e=navigator.userAgent,f=/MSIE|Trident/i.test(e);if(f){var g=/MSIE (\d+[.]\d+)/.exec(e);g&&(b=parseFloat(g[1])),g=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(e),g&&(b=parseFloat(g[1]))}var h=/Edge\/\d+/.test(e),i=!!window.CodeMirror;if(!i&&c)
// Webpack
if("function"==typeof __webpack_require__)// jshint ignore:line
try{
// If CodeMirror can't be resolved, `require.resolve` will throw an
// exception and `hasCodeMirror` won't be set to `true`.
require.resolve("codemirror"),i=!0}catch(j){}else if("undefined"!=typeof require)
// Browserify
if("undefined"!=typeof require.resolve)try{
// If CodeMirror can't be resolved, `require.resolve` will throw an
// exception and `hasCodeMirror` won't be set to `true`.
require.resolve("codemirror"),i=!0}catch(j){}else"undefined"!=typeof require.specified&&(i=require.specified("codemirror"));var k="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,l={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:f,isEdge:h,isFF:!h&&/firefox/i.test(e),isPhantom:/PhantomJS/i.test(e),isWebkit:!h&&/webkit/i.test(e),isChrome:!h&&/chrome/i.test(e),isSafari:!h&&/safari/i.test(e),browserVersion:b,jqueryVersion:parseFloat(a.fn.jquery),isSupportAmd:c,isSupportTouch:k,hasCodeMirror:i,isFontInstalled:d,isW3CRangeSupport:!!document.createRange},m=function(){var b=function(a){return function(b){return a===b}},c=function(a,b){return a===b},d=function(a){return function(b,c){return b[a]===c[a]}},e=function(){return!0},f=function(){return!1},g=function(a){return function(){return!a.apply(a,arguments)}},h=function(a,b){return function(c){return a(c)&&b(c)}},i=function(a){return a},j=function(a,b){return function(){return a[b].apply(a,arguments)}},k=0,l=function(a){var b=++k+"";return a?a+b:b},m=function(b){var c=a(document);return{top:b.top+c.scrollTop(),left:b.left+c.scrollLeft(),width:b.right-b.left,height:b.bottom-b.top}},n=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b},o=function(a,b){return b=b||"",b+a.split(".").map(function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}).join("")},p=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}};return{eq:b,eq2:c,peq2:d,ok:e,fail:f,self:i,not:g,and:h,invoke:j,uniqueId:l,rect2bnd:m,invertObject:n,namespaceToCamel:o,debounce:p}}(),n=function(){/**
     * returns the first item of an array.
     *
     * @param {Array} array
     */
var b=function(a){return a[0]},c=function(a){return a[a.length-1]},d=function(a){return a.slice(0,a.length-1)},e=function(a){return a.slice(1)},f=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e))return e}},g=function(a,b){for(var c=0,d=a.length;c<d;c++)if(!b(a[c]))return!1;return!0},h=function(b,c){return a.inArray(c,b)},i=function(a,b){return h(a,b)!==-1},j=function(a,b){return b=b||m.self,a.reduce(function(a,c){return a+b(c)},0)},k=function(a){for(var b=[],c=-1,d=a.length;++c<d;)b[c]=a[c];return b},l=function(a){return!a||!a.length},n=function(a,d){if(!a.length)return[];var f=e(a);return f.reduce(function(a,b){var e=c(a);return d(c(e),b)?e[e.length]=b:a[a.length]=[b],a},[[b(a)]])},o=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},p=function(a){for(var b=[],c=0,d=a.length;c<d;c++)i(b,a[c])||b.push(a[c]);return b},q=function(a,b){var c=h(a,b);return c===-1?null:a[c+1]},r=function(a,b){var c=h(a,b);return c===-1?null:a[c-1]};return{head:b,last:c,initial:d,tail:e,prev:r,next:q,find:f,contains:i,all:g,sum:j,from:k,isEmpty:l,clusterBy:n,compact:o,unique:p}}(),o=String.fromCharCode(160),p="\ufeff",q=function(){/**
     * @method isEditable
     *
     * returns whether node is `note-editable` or not.
     *
     * @param {Node} node
     * @return {Boolean}
     */
var b=function(b){return b&&a(b).hasClass("note-editable")},c=function(b){return b&&a(b).hasClass("note-control-sizing")},d=function(a){return a=a.toUpperCase(),function(b){return b&&b.nodeName.toUpperCase()===a}},e=function(a){return a&&3===a.nodeType},f=function(a){return a&&1===a.nodeType},g=function(a){return a&&/^BR|^IMG|^HR|^IFRAME|^BUTTON|^INPUT/.test(a.nodeName.toUpperCase())},h=function(a){return!b(a)&&(a&&/^DIV|^P|^LI|^H[1-7]/.test(a.nodeName.toUpperCase()))},i=function(a){return a&&/^H[1-7]/.test(a.nodeName.toUpperCase())},j=d("PRE"),k=d("LI"),r=function(a){return h(a)&&!k(a)},s=d("TABLE"),t=d("DATA"),u=function(a){return!(z(a)||v(a)||w(a)||h(a)||s(a)||y(a)||t(a))},v=function(a){return a&&/^UL|^OL/.test(a.nodeName.toUpperCase())},w=d("HR"),x=function(a){return a&&/^TD|^TH/.test(a.nodeName.toUpperCase())},y=d("BLOCKQUOTE"),z=function(a){return x(a)||y(a)||b(a)},A=d("A"),B=function(a){return u(a)&&!!K(a,h)},C=function(a){return u(a)&&!K(a,h)},D=d("BODY"),E=function(a,b){return a.nextSibling===b||a.previousSibling===b},F=function(a,b){b=b||m.ok;var c=[];return a.previousSibling&&b(a.previousSibling)&&c.push(a.previousSibling),c.push(a),a.nextSibling&&b(a.nextSibling)&&c.push(a.nextSibling),c},G=l.isMSIE&&l.browserVersion<11?"&nbsp;":"<br>",H=function(a){return e(a)?a.nodeValue.length:a?a.childNodes.length:0},I=function(a){var b=H(a);return 0===b||(!e(a)&&1===b&&a.innerHTML===G||!(!n.all(a.childNodes,e)||""!==a.innerHTML))},J=function(a){g(a)||H(a)||(a.innerHTML=G)},K=function(a,c){for(;a;){if(c(a))return a;if(b(a))break;a=a.parentNode}return null},L=function(a,c){for(a=a.parentNode;a&&1===H(a);){if(c(a))return a;if(b(a))break;a=a.parentNode}return null},M=function(a,c){c=c||m.fail;var d=[];return K(a,function(a){return b(a)||d.push(a),c(a)}),d},N=function(a,b){var c=M(a);return n.last(c.filter(b))},O=function(b,c){for(var d=M(b),e=c;e;e=e.parentNode)if(a.inArray(e,d)>-1)return e;return null},P=function(a,b){b=b||m.fail;for(var c=[];a&&!b(a);)c.push(a),a=a.previousSibling;return c},Q=function(a,b){b=b||m.fail;for(var c=[];a&&!b(a);)c.push(a),a=a.nextSibling;return c},R=function(a,b){var c=[];
// start DFS(depth first search) with node
return b=b||m.ok,function d(e){a!==e&&b(e)&&c.push(e);for(var f=0,g=e.childNodes.length;f<g;f++)d(e.childNodes[f])}(a),c},S=function(b,c){var d=b.parentNode,e=a("<"+c+">")[0];return d.insertBefore(e,b),e.appendChild(b),e},T=function(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a},U=function(b,c){return a.each(c,function(a,c){b.appendChild(c)}),b},V=function(a){return 0===a.offset},W=function(a){return a.offset===H(a.node)},X=function(a){return V(a)||W(a)},Y=function(a,b){for(;a&&a!==b;){if(0!==aa(a))return!1;a=a.parentNode}return!0},Z=function(a,b){if(!b)return!1;for(;a&&a!==b;){if(aa(a)!==H(a.parentNode)-1)return!1;a=a.parentNode}return!0},$=function(a,b){return V(a)&&Y(a.node,b)},_=function(a,b){return W(a)&&Z(a.node,b)},aa=function(a){for(var b=0;a=a.previousSibling;)b+=1;return b},ba=function(a){return!!(a&&a.childNodes&&a.childNodes.length)},ca=function(a,c){var d,e;if(0===a.offset){if(b(a.node))return null;d=a.node.parentNode,e=aa(a.node)}else ba(a.node)?(d=a.node.childNodes[a.offset-1],e=H(d)):(d=a.node,e=c?0:a.offset-1);return{node:d,offset:e}},da=function(a,c){var d,e;if(H(a.node)===a.offset){if(b(a.node))return null;d=a.node.parentNode,e=aa(a.node)+1}else ba(a.node)?(d=a.node.childNodes[a.offset],e=0):(d=a.node,e=c?H(a.node):a.offset+1);return{node:d,offset:e}},ea=function(a,b){return a.node===b.node&&a.offset===b.offset},fa=function(a){if(e(a.node)||!ba(a.node)||I(a.node))return!0;var b=a.node.childNodes[a.offset-1],c=a.node.childNodes[a.offset];return!(b&&!g(b)||c&&!g(c))},ga=function(a,b){for(;a;){if(b(a))return a;a=ca(a)}return null},ha=function(a,b){for(;a;){if(b(a))return a;a=da(a)}return null},ia=function(a){if(!e(a.node))return!1;var b=a.node.nodeValue.charAt(a.offset-1);return b&&" "!==b&&b!==o},ja=function(a,b,c,d){for(var e=a;e&&(c(e),!ea(e,b));){var f=d&&a.node!==e.node&&b.node!==e.node;e=da(e,f)}},ka=function(a,b){var c=M(b,m.eq(a));return c.map(aa).reverse()},la=function(a,b){for(var c=a,d=0,e=b.length;d<e;d++)c=c.childNodes.length<=b[d]?c.childNodes[c.childNodes.length-1]:c.childNodes[b[d]];return c},ma=function(a,b){var c=b&&b.isSkipPaddingBlankHTML,d=b&&b.isNotSplitEdgePoint;
// edge case
if(X(a)&&(e(a.node)||d)){if(V(a))return a.node;if(W(a))return a.node.nextSibling}
// split #text
if(e(a.node))return a.node.splitText(a.offset);var f=a.node.childNodes[a.offset],g=T(a.node.cloneNode(!1),a.node);return U(g,Q(f)),c||(J(a.node),J(g)),g},na=function(a,b,c){
// ex) [#text, <span>, <p>]
var d=M(b.node,m.eq(a));return d.length?1===d.length?ma(b,c):d.reduce(function(a,d){return a===b.node&&(a=ma(b,c)),ma({node:d,offset:a?q.position(a):H(d)},c)}):null},oa=function(a,b){
// find splitRoot, container
//  - inline: splitRoot is a child of paragraph
//  - block: splitRoot is a child of bodyContainer
var c,d,e=b?h:z,f=M(a.node,e),g=n.last(f)||a.node;e(g)?(c=f[f.length-2],d=g):(c=g,d=c.parentNode);
// if splitRoot is exists, split with splitTree
var i=c&&na(c,a,{isSkipPaddingBlankHTML:b,isNotSplitEdgePoint:b});
// if container is point.node, find pivot with point.offset
return i||d!==a.node||(i=a.node.childNodes[a.offset]),{rightNode:i,container:d}},pa=function(a){return document.createElement(a)},qa=function(a){return document.createTextNode(a)},ra=function(a,b){if(a&&a.parentNode){if(a.removeNode)return a.removeNode(b);var c=a.parentNode;if(!b){var d,e,f=[];for(d=0,e=a.childNodes.length;d<e;d++)f.push(a.childNodes[d]);for(d=0,e=f.length;d<e;d++)c.insertBefore(f[d],a)}c.removeChild(a)}},sa=function(a,c){for(;a&&!b(a)&&c(a);){var d=a.parentNode;ra(a),a=d}},ta=function(a,b){if(a.nodeName.toUpperCase()===b.toUpperCase())return a;var c=pa(b);return a.style.cssText&&(c.style.cssText=a.style.cssText),U(c,n.from(a.childNodes)),T(c,a),ra(a),c},ua=d("TEXTAREA"),va=function(a,b){var c=ua(a[0])?a.val():a.html();return b?c.replace(/[\n\r]/g,""):c},wa=function(b,c){var d=va(b);if(c){var e=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;d=d.replace(e,function(a,b,c){c=c.toUpperCase();var d=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(c)&&!!b,e=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(c);return a+(d||e?"\n":"")}),d=a.trim(d)}return d},xa=function(b){var c=a(b),d=c.offset(),e=c.outerHeight(!0);// include margin
return{left:d.left,top:d.top+e}},ya=function(a,b){Object.keys(b).forEach(function(c){a.on(c,b[c])})},za=function(a,b){Object.keys(b).forEach(function(c){a.off(c,b[c])})},Aa=function(a){return a&&!q.isText(a)&&n.contains(a.classList,"note-styletag")};return{/** @property {String} NBSP_CHAR */
NBSP_CHAR:o,/** @property {String} ZERO_WIDTH_NBSP_CHAR */
ZERO_WIDTH_NBSP_CHAR:p,/** @property {String} blank */
blank:G,/** @property {String} emptyPara */
emptyPara:"<p>"+G+"</p>",makePredByNodeName:d,isEditable:b,isControlSizing:c,isText:e,isElement:f,isVoid:g,isPara:h,isPurePara:r,isHeading:i,isInline:u,isBlock:m.not(u),isBodyInline:C,isBody:D,isParaInline:B,isPre:j,isList:v,isTable:s,isData:t,isCell:x,isBlockquote:y,isBodyContainer:z,isAnchor:A,isDiv:d("DIV"),isLi:k,isBR:d("BR"),isSpan:d("SPAN"),isB:d("B"),isU:d("U"),isS:d("S"),isI:d("I"),isImg:d("IMG"),isTextarea:ua,isEmpty:I,isEmptyAnchor:m.and(A,I),isClosestSibling:E,withClosestSiblings:F,nodeLength:H,isLeftEdgePoint:V,isRightEdgePoint:W,isEdgePoint:X,isLeftEdgeOf:Y,isRightEdgeOf:Z,isLeftEdgePointOf:$,isRightEdgePointOf:_,prevPoint:ca,nextPoint:da,isSamePoint:ea,isVisiblePoint:fa,prevPointUntil:ga,nextPointUntil:ha,isCharPoint:ia,walkPoint:ja,ancestor:K,singleChildAncestor:L,listAncestor:M,lastAncestor:N,listNext:Q,listPrev:P,listDescendant:R,commonAncestor:O,wrap:S,insertAfter:T,appendChildNodes:U,position:aa,hasChildren:ba,makeOffsetPath:ka,fromOffsetPath:la,splitTree:na,splitPoint:oa,create:pa,createText:qa,remove:ra,removeWhile:sa,replace:ta,html:wa,value:va,posFromPlaceholder:xa,attachEvents:ya,detachEvents:za,isCustomStyleTag:Aa}}(),r=function(b,c){var d=this,e=a.summernote.ui;/**
     * create layout and initialize modules and other resources
     */
/**
     * destroy modules and other resources and remove layout
     */
/**
     * destory modules and other resources and initialize it again
     */
/**
     *Some buttons need to change their visual style immediately once they get pressed
     */
return this.memos={},this.modules={},this.layoutInfo={},this.options=c,this.initialize=function(){return this.layoutInfo=e.createLayout(b,c),this._initialize(),b.hide(),this},this.destroy=function(){this._destroy(),b.removeData("summernote"),e.removeLayout(b,this.layoutInfo)},this.reset=function(){var a=d.isDisabled();this.code(q.emptyPara),this._destroy(),this._initialize(),a&&d.disable()},this._initialize=function(){
// add optional buttons
var b=a.extend({},this.options.buttons);Object.keys(b).forEach(function(a){d.memo("button."+a,b[a])});var c=a.extend({},this.options.modules,a.summernote.plugins||{});
// add and initialize modules
Object.keys(c).forEach(function(a){d.module(a,c[a],!0)}),Object.keys(this.modules).forEach(function(a){d.initializeModule(a)})},this._destroy=function(){
// destroy modules with reversed order
Object.keys(this.modules).reverse().forEach(function(a){d.removeModule(a)}),Object.keys(this.memos).forEach(function(a){d.removeMemo(a)}),
// trigger custom onDestroy callback
this.triggerEvent("destroy",this)},this.code=function(a){var c=this.invoke("codeview.isActivated");return void 0===a?(this.invoke("codeview.sync"),c?this.layoutInfo.codable.val():this.layoutInfo.editable.html()):(c?this.layoutInfo.codable.val(a):this.layoutInfo.editable.html(a),b.val(a),this.triggerEvent("change",a),void 0)},this.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},this.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0),this.triggerEvent("disable",!1)},this.disable=function(){
// close codeview if codeview is opend
this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0),this.triggerEvent("disable",!0)},this.triggerEvent=function(){var a=n.head(arguments),c=n.tail(n.from(arguments)),d=this.options.callbacks[m.namespaceToCamel(a,"on")];d&&d.apply(b[0],c),b.trigger("summernote."+a,c)},this.initializeModule=function(a){var c=this.modules[a];c.shouldInitialize=c.shouldInitialize||m.ok,c.shouldInitialize()&&(
// initialize module
c.initialize&&c.initialize(),
// attach events
c.events&&q.attachEvents(b,c.events))},this.module=function(a,b,c){return 1===arguments.length?this.modules[a]:(this.modules[a]=new b(this),void(c||this.initializeModule(a)))},this.removeModule=function(a){var c=this.modules[a];c.shouldInitialize()&&(c.events&&q.detachEvents(b,c.events),c.destroy&&c.destroy()),delete this.modules[a]},this.memo=function(a,b){return 1===arguments.length?this.memos[a]:void(this.memos[a]=b)},this.removeMemo=function(a){this.memos[a]&&this.memos[a].destroy&&this.memos[a].destroy(),delete this.memos[a]},this.createInvokeHandlerAndUpdateState=function(a,b){return function(c){d.createInvokeHandler(a,b)(c),d.invoke("buttons.updateCurrentStyle")}},this.createInvokeHandler=function(b,c){return function(e){e.preventDefault();var f=a(e.target);d.invoke(b,c||f.closest("[data-value]").data("value"),f)}},this.invoke=function(){var a=n.head(arguments),b=n.tail(n.from(arguments)),c=a.split("."),d=c.length>1,e=d&&n.head(c),f=d?n.last(c):n.head(c),g=this.modules[e||"editor"];return!e&&this[f]?this[f].apply(this,b):g&&g[f]&&g.shouldInitialize()?g[f].apply(g,b):void 0},this.initialize()};a.fn.extend({/**
     * Summernote API
     *
     * @param {Object|String}
     * @return {this}
     */
summernote:function(){var b=a.type(n.head(arguments)),c="string"===b,d="object"===b,e=d?n.head(arguments):{};e=a.extend({},a.summernote.options,e),
// Update options
e.langInfo=a.extend(!0,{},a.summernote.lang["en-US"],a.summernote.lang[e.lang]),e.icons=a.extend(!0,{},a.summernote.options.icons,e.icons),e.tooltip="auto"===e.tooltip?!l.isSupportTouch:e.tooltip,this.each(function(b,c){var d=a(c);if(!d.data("summernote")){var f=new r(d,e);d.data("summernote",f),d.data("summernote").triggerEvent("init",f.layoutInfo)}});var f=this.first();if(f.length){var g=f.data("summernote");if(c)return g.invoke.apply(g,n.from(arguments));e.focus&&g.invoke("editor.focus")}return this}});var s=function(b,c,d,e){this.render=function(f){var g=a(b);if(d&&d.contents&&g.html(d.contents),d&&d.className&&g.addClass(d.className),d&&d.data&&a.each(d.data,function(a,b){g.attr("data-"+a,b)}),d&&d.click&&g.on("click",d.click),c){var h=g.find(".note-children-container");c.forEach(function(a){a.render(h.length?h:g)})}return e&&e(g,d),d&&d.callback&&d.callback(g),f&&f.append(g),g}},t={create:function(b,c){return function(){var d=a.isArray(arguments[0])?arguments[0]:[],e="object"==typeof arguments[1]?arguments[1]:arguments[0];return e&&e.children&&(d=e.children),new s(b,d,e,c)}}},u=t.create('<div class="note-editor note-frame panel panel-default"/>'),v=t.create('<div class="note-toolbar panel-heading"/>'),w=t.create('<div class="note-editing-area"/>'),x=t.create('<textarea class="note-codable"/>'),y=t.create('<div class="note-editable panel-body" contentEditable="true"/>'),z=t.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join("")),A=t.create('<div class="note-editor"/>'),B=t.create('<div class="note-editable" contentEditable="true"/>'),C=t.create('<div class="note-btn-group btn-group">'),D=t.create('<div class="dropdown-menu">',function(b,c){var d=a.isArray(c.items)?c.items.map(function(a){var b="string"==typeof a?a:a.value||"",d=c.template?c.template(a):a,e="object"==typeof a?a.option:void 0,f='data-value="'+b+'"',g=void 0!==e?' data-option="'+e+'"':"";return'<li><a href="#" '+(f+g)+">"+d+"</a></li>"}).join(""):c.items;b.html(d)}),E=function(a,b){return a+" "+K(b.icons.caret,"span")},F=t.create('<div class="dropdown-menu note-check">',function(b,c){var d=a.isArray(c.items)?c.items.map(function(a){var b="string"==typeof a?a:a.value||"",d=c.template?c.template(a):a;return'<li><a href="#" data-value="'+b+'">'+K(c.checkClassName)+" "+d+"</a></li>"}).join(""):c.items;b.html(d)}),G=t.create('<div class="note-color-palette"/>',function(a,b){for(var c=[],d=0,e=b.colors.length;d<e;d++){for(var f=b.eventName,g=b.colors[d],h=[],i=0,j=g.length;i<j;i++){var k=g[i];h.push(['<button type="button" class="note-color-btn"','style="background-color:',k,'" ','data-event="',f,'" ','data-value="',k,'" ','title="',k,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}c.push('<div class="note-color-row">'+h.join("")+"</div>")}a.html(c.join("")),b.tooltip&&a.find(".note-color-btn").tooltip({container:"body",trigger:"hover",placement:"bottom"})}),H=t.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',function(a,b){b.fade&&a.addClass("fade"),a.html(['<div class="modal-dialog">','  <div class="modal-content">',b.title?'    <div class="modal-header">      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>      <h4 class="modal-title">'+b.title+"</h4>    </div>":"",'    <div class="modal-body">'+b.body+"</div>",b.footer?'    <div class="modal-footer">'+b.footer+"</div>":"","  </div>","</div>"].join(""))}),I=t.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),function(a,b){var c="undefined"!=typeof b.direction?b.direction:"bottom";a.addClass(c),b.hideArrow&&a.find(".arrow").hide()}),J=t.create('<div class="checkbox"></div>',function(a,b){a.html([" <label"+(b.id?' for="'+b.id+'"':"")+">",' <input type="checkbox"'+(b.id?' id="'+b.id+'"':""),(b.checked?" checked":"")+"/>",b.text?b.text:"","</label>"].join(""))}),K=function(a,b){return b=b||"i","<"+b+' class="'+a+'"/>'},L={editor:u,toolbar:v,editingArea:w,codable:x,editable:y,statusbar:z,airEditor:A,airEditable:B,buttonGroup:C,dropdown:D,dropdownButtonContents:E,dropdownCheck:F,palette:G,dialog:H,popover:I,checkbox:J,icon:K,options:{},button:function(a,b){return t.create('<button type="button" class="note-btn btn btn-default btn-sm" tabindex="-1">',function(a,b){b&&b.tooltip&&self.options.tooltip&&a.attr({title:b.tooltip}).tooltip({container:"body",trigger:"hover",placement:"bottom"})})(a,b)},toggleBtn:function(a,b){a.toggleClass("disabled",!b),a.attr("disabled",!b)},toggleBtnActive:function(a,b){a.toggleClass("active",b)},onDialogShown:function(a,b){a.one("shown.bs.modal",b)},onDialogHidden:function(a,b){a.one("hidden.bs.modal",b)},showDialog:function(a){a.modal("show")},hideDialog:function(a){a.modal("hide")},createLayout:function(a,b){self.options=b;var c=(b.airMode?L.airEditor([L.editingArea([L.airEditable()])]):L.editor([L.toolbar(),L.editingArea([L.codable(),L.editable()]),L.statusbar()])).render();return c.insertAfter(a),{note:a,editor:c,toolbar:c.find(".note-toolbar"),editingArea:c.find(".note-editing-area"),editable:c.find(".note-editable"),codable:c.find(".note-codable"),statusbar:c.find(".note-statusbar")}},removeLayout:function(a,b){a.html(b.editable.html()),b.editor.remove(),a.show()}};a.summernote=a.summernote||{lang:{}},a.extend(a.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",addRowAbove:"Add row above",addRowBelow:"Add row below",addColLeft:"Add column left",addColRight:"Add column right",delRow:"Delete row",delCol:"Delete column",delTable:"Delete table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});/**
   * @class core.key
   *
   * Object for keycodes.
   *
   * @singleton
   * @alternateClassName key
   */
var M=function(){var a={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,DELETE:46,
// Arrow
LEFT:37,UP:38,RIGHT:39,DOWN:40,
// Number: 0-9
NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,
// Alphabet: a-z
B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{/**
       * @method isEdit
       *
       * @param {Number} keyCode
       * @return {Boolean}
       */
isEdit:function(b){return n.contains([a.BACKSPACE,a.TAB,a.ENTER,a.SPACE,a.DELETE],b)},/**
       * @method isMove
       *
       * @param {Number} keyCode
       * @return {Boolean}
       */
isMove:function(b){return n.contains([a.LEFT,a.UP,a.RIGHT,a.DOWN],b)},/**
       * @property {Object} nameFromCode
       * @property {String} nameFromCode.8 "BACKSPACE"
       */
nameFromCode:m.invertObject(a),code:a}}(),N=function(){/**
     * return boundaryPoint from TextRange, inspired by Andy Na's HuskyRange.js
     *
     * @param {TextRange} textRange
     * @param {Boolean} isStart
     * @return {BoundaryPoint}
     *
     * @see http://msdn.microsoft.com/en-us/library/ie/ms535872(v=vs.85).aspx
     */
var b=function(a,b){var c,d,e=a.parentElement(),f=document.body.createTextRange(),g=n.from(e.childNodes);for(c=0;c<g.length;c++)if(!q.isText(g[c])){if(f.moveToElementText(g[c]),f.compareEndPoints("StartToStart",a)>=0)break;d=g[c]}if(0!==c&&q.isText(g[c-1])){var h=document.body.createTextRange(),i=null;h.moveToElementText(d||e),h.collapse(!d),i=d?d.nextSibling:e.firstChild;var j=a.duplicate();j.setEndPoint("StartToStart",h);for(var k=j.text.replace(/[\r\n]/g,"").length;k>i.nodeValue.length&&i.nextSibling;)k-=i.nodeValue.length,i=i.nextSibling;/* jshint ignore:start */
i.nodeValue;// enforce IE to re-reference curTextNode, hack
/* jshint ignore:end */
b&&i.nextSibling&&q.isText(i.nextSibling)&&k===i.nodeValue.length&&(k-=i.nodeValue.length,i=i.nextSibling),e=i,c=k}return{cont:e,offset:c}},c=function(a){var b=function(a,c){var d,e;if(q.isText(a)){var f=q.listPrev(a,m.not(q.isText)),g=n.last(f).previousSibling;d=g||a.parentNode,c+=n.sum(n.tail(f),q.nodeLength),e=!g}else{if(d=a.childNodes[c]||a,q.isText(d))return b(d,0);c=0,e=!1}return{node:d,collapseToStart:e,offset:c}},c=document.body.createTextRange(),d=b(a.node,a.offset);return c.moveToElementText(d.node),c.collapse(d.collapseToStart),c.moveStart("character",d.offset),c},d=function(b,e,f,g){this.sc=b,this.so=e,this.ec=f,this.eo=g;
// nativeRange: get nativeRange from sc, so, ec, eo
var h=function(){if(l.isW3CRangeSupport){var a=document.createRange();return a.setStart(b,e),a.setEnd(f,g),a}var d=c({node:b,offset:e});return d.setEndPoint("EndToEnd",c({node:f,offset:g})),d};this.getPoints=function(){return{sc:b,so:e,ec:f,eo:g}},this.getStartPoint=function(){return{node:b,offset:e}},this.getEndPoint=function(){return{node:f,offset:g}},/**
       * select update visible range
       */
this.select=function(){var a=h();if(l.isW3CRangeSupport){var b=document.getSelection();b.rangeCount>0&&b.removeAllRanges(),b.addRange(a)}else a.select();return this},/**
       * Moves the scrollbar to start container(sc) of current range
       *
       * @return {WrappedRange}
       */
this.scrollIntoView=function(b){var c=a(b).height();return b.scrollTop+c<this.sc.offsetTop&&(b.scrollTop+=Math.abs(b.scrollTop+c-this.sc.offsetTop)),this},/**
       * @return {WrappedRange}
       */
this.normalize=function(){/**
         * @param {BoundaryPoint} point
         * @param {Boolean} isLeftToRight
         * @return {BoundaryPoint}
         */
var a=function(a,b){if(q.isVisiblePoint(a)&&!q.isEdgePoint(a)||q.isVisiblePoint(a)&&q.isRightEdgePoint(a)&&!b||q.isVisiblePoint(a)&&q.isLeftEdgePoint(a)&&b||q.isVisiblePoint(a)&&q.isBlock(a.node)&&q.isEmpty(a.node))return a;
// point on block's edge
var c=q.ancestor(a.node,q.isBlock);if((q.isLeftEdgePointOf(a,c)||q.isVoid(q.prevPoint(a).node))&&!b||(q.isRightEdgePointOf(a,c)||q.isVoid(q.nextPoint(a).node))&&b){
// returns point already on visible point
if(q.isVisiblePoint(a))return a;
// reverse direction 
b=!b}var d=b?q.nextPointUntil(q.nextPoint(a),q.isVisiblePoint):q.prevPointUntil(q.prevPoint(a),q.isVisiblePoint);return d||a},b=a(this.getEndPoint(),!1),c=this.isCollapsed()?b:a(this.getStartPoint(),!0);return new d(c.node,c.offset,b.node,b.offset)},/**
       * returns matched nodes on range
       *
       * @param {Function} [pred] - predicate function
       * @param {Object} [options]
       * @param {Boolean} [options.includeAncestor]
       * @param {Boolean} [options.fullyContains]
       * @return {Node[]}
       */
this.nodes=function(a,b){a=a||m.ok;var c=b&&b.includeAncestor,d=b&&b.fullyContains,e=this.getStartPoint(),f=this.getEndPoint(),g=[],h=[];return q.walkPoint(e,f,function(b){if(!q.isEditable(b.node)){var e;d?(q.isLeftEdgePoint(b)&&h.push(b.node),q.isRightEdgePoint(b)&&n.contains(h,b.node)&&(e=b.node)):e=c?q.ancestor(b.node,a):b.node,e&&a(e)&&g.push(e)}},!0),n.unique(g)},/**
       * returns commonAncestor of range
       * @return {Element} - commonAncestor
       */
this.commonAncestor=function(){return q.commonAncestor(b,f)},/**
       * returns expanded range by pred
       *
       * @param {Function} pred - predicate function
       * @return {WrappedRange}
       */
this.expand=function(a){var c=q.ancestor(b,a),h=q.ancestor(f,a);if(!c&&!h)return new d(b,e,f,g);var i=this.getPoints();return c&&(i.sc=c,i.so=0),h&&(i.ec=h,i.eo=q.nodeLength(h)),new d(i.sc,i.so,i.ec,i.eo)},/**
       * @param {Boolean} isCollapseToStart
       * @return {WrappedRange}
       */
this.collapse=function(a){return a?new d(b,e,b,e):new d(f,g,f,g)},/**
       * splitText on range
       */
this.splitText=function(){var a=b===f,c=this.getPoints();return q.isText(f)&&!q.isEdgePoint(this.getEndPoint())&&f.splitText(g),q.isText(b)&&!q.isEdgePoint(this.getStartPoint())&&(c.sc=b.splitText(e),c.so=0,a&&(c.ec=c.sc,c.eo=g-e)),new d(c.sc,c.so,c.ec,c.eo)},/**
       * delete contents on range
       * @return {WrappedRange}
       */
this.deleteContents=function(){if(this.isCollapsed())return this;var b=this.splitText(),c=b.nodes(null,{fullyContains:!0}),e=q.prevPointUntil(b.getStartPoint(),function(a){return!n.contains(c,a.node)}),f=[];
// remove empty parents
return a.each(c,function(a,b){
// find empty parents
var c=b.parentNode;e.node!==c&&1===q.nodeLength(c)&&f.push(c),q.remove(b,!1)}),a.each(f,function(a,b){q.remove(b,!1)}),new d(e.node,e.offset,e.node,e.offset).normalize()};/**
       * makeIsOn: return isOn(pred) function
       */
var i=function(a){return function(){var c=q.ancestor(b,a);return!!c&&c===q.ancestor(f,a)}};
// isOnEditable: judge whether range is on editable or not
this.isOnEditable=i(q.isEditable),
// isOnList: judge whether range is on list node or not
this.isOnList=i(q.isList),
// isOnAnchor: judge whether range is on anchor node or not
this.isOnAnchor=i(q.isAnchor),
// isOnCell: judge whether range is on cell node or not
this.isOnCell=i(q.isCell),
// isOnData: judge whether range is on data node or not
this.isOnData=i(q.isData),/**
       * @param {Function} pred
       * @return {Boolean}
       */
this.isLeftEdgeOf=function(a){if(!q.isLeftEdgePoint(this.getStartPoint()))return!1;var b=q.ancestor(this.sc,a);return b&&q.isLeftEdgeOf(this.sc,b)},/**
       * returns whether range was collapsed or not
       */
this.isCollapsed=function(){return b===f&&e===g},/**
       * wrap inline nodes which children of body with paragraph
       *
       * @return {WrappedRange}
       */
this.wrapBodyInlineWithPara=function(){if(q.isBodyContainer(b)&&q.isEmpty(b))return b.innerHTML=q.emptyPara,new d(b.firstChild,0,b.firstChild,0);/**
         * [workaround] firefox often create range on not visible point. so normalize here.
         *  - firefox: |<p>text</p>|
         *  - chrome: <p>|text|</p>
         */
var a=this.normalize();if(q.isParaInline(b)||q.isPara(b))return a;
// find inline top ancestor
var c;if(q.isInline(a.sc)){var e=q.listAncestor(a.sc,m.not(q.isInline));c=n.last(e),q.isInline(c)||(c=e[e.length-2]||a.sc.childNodes[a.so])}else c=a.sc.childNodes[a.so>0?a.so-1:0];
// siblings not in paragraph
var f=q.listPrev(c,q.isParaInline).reverse();
// wrap with paragraph
if(f=f.concat(q.listNext(c.nextSibling,q.isParaInline)),f.length){var g=q.wrap(n.head(f),"p");q.appendChildNodes(g,n.tail(f))}return this.normalize()},/**
       * insert node at current cursor
       *
       * @param {Node} node
       * @return {Node}
       */
this.insertNode=function(a){var b=this.wrapBodyInlineWithPara().deleteContents(),c=q.splitPoint(b.getStartPoint(),q.isInline(a));return c.rightNode?c.rightNode.parentNode.insertBefore(a,c.rightNode):c.container.appendChild(a),a},/**
       * insert html at current cursor
       */
this.pasteHTML=function(b){var c=a("<div></div>").html(b)[0],d=n.from(c.childNodes),e=this.wrapBodyInlineWithPara().deleteContents();return d.reverse().map(function(a){return e.insertNode(a)}).reverse()},/**
       * returns text in range
       *
       * @return {String}
       */
this.toString=function(){var a=h();return l.isW3CRangeSupport?a.toString():a.text},/**
       * returns range for word before cursor
       *
       * @param {Boolean} [findAfter] - find after cursor, default: false
       * @return {WrappedRange}
       */
this.getWordRange=function(a){var b=this.getEndPoint();if(!q.isCharPoint(b))return this;var c=q.prevPointUntil(b,function(a){return!q.isCharPoint(a)});return a&&(b=q.nextPointUntil(b,function(a){return!q.isCharPoint(a)})),new d(c.node,c.offset,b.node,b.offset)},/**
       * create offsetPath bookmark
       *
       * @param {Node} editable
       */
this.bookmark=function(a){return{s:{path:q.makeOffsetPath(a,b),offset:e},e:{path:q.makeOffsetPath(a,f),offset:g}}},/**
       * create offsetPath bookmark base on paragraph
       *
       * @param {Node[]} paras
       */
this.paraBookmark=function(a){return{s:{path:n.tail(q.makeOffsetPath(n.head(a),b)),offset:e},e:{path:n.tail(q.makeOffsetPath(n.last(a),f)),offset:g}}},/**
       * getClientRects
       * @return {Rect[]}
       */
this.getClientRects=function(){var a=h();return a.getClientRects()}};/**
   * @class core.range
   *
   * Data structure
   *  * BoundaryPoint: a point of dom tree
   *  * BoundaryPoints: two boundaryPoints corresponding to the start and the end of the Range
   *
   * See to http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Position
   *
   * @singleton
   * @alternateClassName range
   */
return{/**
       * create Range Object From arguments or Browser Selection
       *
       * @param {Node} sc - start container
       * @param {Number} so - start offset
       * @param {Node} ec - end container
       * @param {Number} eo - end offset
       * @return {WrappedRange}
       */
create:function(a,b,c,e){if(4===arguments.length)return new d(a,b,c,e);if(2===arguments.length)//collapsed
return c=a,e=b,new d(a,b,c,e);var f=this.createFromSelection();return f||1!==arguments.length?f:(f=this.createFromNode(arguments[0]),f.collapse(q.emptyPara===arguments[0].innerHTML))},createFromSelection:function(){var a,c,e,f;if(l.isW3CRangeSupport){var g=document.getSelection();if(!g||0===g.rangeCount)return null;if(q.isBody(g.anchorNode))
// Firefox: returns entire body as range on initialization.
// We won't never need it.
return null;var h=g.getRangeAt(0);a=h.startContainer,c=h.startOffset,e=h.endContainer,f=h.endOffset}else{// IE8: TextRange
var i=document.selection.createRange(),j=i.duplicate();j.collapse(!1);var k=i;k.collapse(!0);var m=b(k,!0),n=b(j,!1);
// same visible point case: range was collapsed.
q.isText(m.node)&&q.isLeftEdgePoint(m)&&q.isTextNode(n.node)&&q.isRightEdgePoint(n)&&n.node.nextSibling===m.node&&(m=n),a=m.cont,c=m.offset,e=n.cont,f=n.offset}return new d(a,c,e,f)},/**
       * @method 
       * 
       * create WrappedRange from node
       *
       * @param {Node} node
       * @return {WrappedRange}
       */
createFromNode:function(a){var b=a,c=0,d=a,e=q.nodeLength(d);
// browsers can't target a picture or void node
return q.isVoid(b)&&(c=q.listPrev(b).length-1,b=b.parentNode),q.isBR(d)?(e=q.listPrev(d).length-1,d=d.parentNode):q.isVoid(d)&&(e=q.listPrev(d).length,d=d.parentNode),this.create(b,c,d,e)},/**
       * create WrappedRange from node after position
       *
       * @param {Node} node
       * @return {WrappedRange}
       */
createFromNodeBefore:function(a){return this.createFromNode(a).collapse(!0)},/**
       * create WrappedRange from node after position
       *
       * @param {Node} node
       * @return {WrappedRange}
       */
createFromNodeAfter:function(a){return this.createFromNode(a).collapse()},/**
       * @method 
       * 
       * create WrappedRange from bookmark
       *
       * @param {Node} editable
       * @param {Object} bookmark
       * @return {WrappedRange}
       */
createFromBookmark:function(a,b){var c=q.fromOffsetPath(a,b.s.path),e=b.s.offset,f=q.fromOffsetPath(a,b.e.path),g=b.e.offset;return new d(c,e,f,g)},/**
       * @method 
       *
       * create WrappedRange from paraBookmark
       *
       * @param {Object} bookmark
       * @param {Node[]} paras
       * @return {WrappedRange}
       */
createFromParaBookmark:function(a,b){var c=a.s.offset,e=a.e.offset,f=q.fromOffsetPath(n.head(b),a.s.path),g=q.fromOffsetPath(n.last(b),a.e.path);return new d(f,c,g,e)}}}(),O=function(){/**
     * @method readFileAsDataURL
     *
     * read contents of file as representing URL
     *
     * @param {File} file
     * @return {Promise} - then: dataUrl
     */
var b=function(b){return a.Deferred(function(c){a.extend(new FileReader,{onload:function(a){var b=a.target.result;c.resolve(b)},onerror:function(){c.reject(this)}}).readAsDataURL(b)}).promise()},c=function(b){return a.Deferred(function(c){var d=a("<img>");d.one("load",function(){d.off("error abort"),c.resolve(d)}).one("error abort",function(){d.off("load").detach(),c.reject(d)}).css({display:"none"}).appendTo(document.body).attr("src",b)}).promise()};return{readFileAsDataURL:b,createImage:c}}(),P=function(a){var b=[],c=-1,d=a[0],e=function(){var b=N.create(d),c={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:a.html(),bookmark:b?b.bookmark(d):c}},f=function(b){null!==b.contents&&a.html(b.contents),null!==b.bookmark&&N.createFromBookmark(d,b.bookmark).select()};/**
    * @method rewind
    * Rewinds the history stack back to the first snapshot taken.
    * Leaves the stack intact, so that "Redo" can still be used.
    */
this.rewind=function(){
// Create snap shot if not yet recorded
a.html()!==b[c].contents&&this.recordUndo(),
// Return to the first available snapshot.
c=0,
// Apply that snapshot.
f(b[c])},/**
    * @method reset
    * Resets the history stack completely; reverting to an empty editor.
    */
this.reset=function(){
// Clear the stack.
b=[],
// Restore stackOffset to its original value.
c=-1,
// Clear the editable area.
a.html(""),
// Record our first snapshot (of nothing).
this.recordUndo()},/**
     * undo
     */
this.undo=function(){
// Create snap shot if not yet recorded
a.html()!==b[c].contents&&this.recordUndo(),0<c&&(c--,f(b[c]))},/**
     * redo
     */
this.redo=function(){b.length-1>c&&(c++,f(b[c]))},/**
     * recorded undo
     */
this.recordUndo=function(){c++,
// Wash out stack after stackOffset
b.length>c&&(b=b.slice(0,c)),
// Create new snapshot and push it to the end
b.push(e())}},Q=function(){/**
     * @method jQueryCSS
     *
     * [workaround] for old jQuery
     * passing an array of style properties to .css()
     * will result in an object of property-value pairs.
     * (compability with version < 1.9)
     *
     * @private
     * @param  {jQuery} $obj
     * @param  {Array} propertyNames - An array of one or more CSS properties.
     * @return {Object}
     */
var b=function(b,c){if(l.jqueryVersion<1.9){var d={};return a.each(c,function(a,c){d[c]=b.css(c)}),d}return b.css.call(b,c)};/**
     * returns style object from node
     *
     * @param {jQuery} $node
     * @return {Object}
     */
this.fromNode=function(a){var c=["font-family","font-size","text-align","list-style-type","line-height"],d=b(a,c)||{};return d["font-size"]=parseInt(d["font-size"],10),d},/**
     * paragraph level style
     *
     * @param {WrappedRange} rng
     * @param {Object} styleInfo
     */
this.stylePara=function(b,c){a.each(b.nodes(q.isPara,{includeAncestor:!0}),function(b,d){a(d).css(c)})},/**
     * insert and returns styleNodes on range.
     *
     * @param {WrappedRange} rng
     * @param {Object} [options] - options for styleNodes
     * @param {String} [options.nodeName] - default: `SPAN`
     * @param {Boolean} [options.expandClosestSibling] - default: `false`
     * @param {Boolean} [options.onlyPartialContains] - default: `false`
     * @return {Node[]}
     */
this.styleNodes=function(b,c){b=b.splitText();var d=c&&c.nodeName||"SPAN",e=!(!c||!c.expandClosestSibling),f=!(!c||!c.onlyPartialContains);if(b.isCollapsed())return[b.insertNode(q.create(d))];var g=q.makePredByNodeName(d),h=b.nodes(q.isText,{fullyContains:!0}).map(function(a){return q.singleChildAncestor(a,g)||q.wrap(a,d)});if(e){if(f){var i=b.nodes();
// compose with partial contains predication
g=m.and(g,function(a){return n.contains(i,a)})}return h.map(function(b){var c=q.withClosestSiblings(b,g),d=n.head(c),e=n.tail(c);return a.each(e,function(a,b){q.appendChildNodes(d,b.childNodes),q.remove(b)}),n.head(c)})}return h},/**
     * get current style on cursor
     *
     * @param {WrappedRange} rng
     * @return {Object} - object contains style properties.
     */
this.current=function(b){var c=a(q.isElement(b.sc)?b.sc:b.sc.parentNode),d=this.fromNode(c);
// document.queryCommandState for toggle state
// [workaround] prevent Firefox nsresult: "0x80004005 (NS_ERROR_FAILURE)"
try{d=a.extend(d,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal","font-family":document.queryCommandValue("fontname")||d["font-family"]})}catch(e){}
// list-style-type to list-style(unordered, ordered)
if(b.isOnList()){var f=["circle","disc","disc-leading-zero","square"],g=a.inArray(d["list-style-type"],f)>-1;d["list-style"]=g?"unordered":"ordered"}else d["list-style"]="none";var h=q.ancestor(b.sc,q.isPara);if(h&&h.style["line-height"])d["line-height"]=h.style.lineHeight;else{var i=parseInt(d["line-height"],10)/parseInt(d["font-size"],10);d["line-height"]=i.toFixed(1)}return d.anchor=b.isOnAnchor()&&q.ancestor(b.sc,q.isAnchor),d.ancestors=q.listAncestor(b.sc,q.isEditable),d.range=b,d}},R=function(){var b=this;/**
     * toggle ordered list
     */
this.insertOrderedList=function(a){this.toggleList("OL",a)},/**
     * toggle unordered list
     */
this.insertUnorderedList=function(a){this.toggleList("UL",a)},/**
     * indent
     */
this.indent=function(b){var c=this,d=N.create(b).wrapBodyInlineWithPara(),e=d.nodes(q.isPara,{includeAncestor:!0}),f=n.clusterBy(e,m.peq2("parentNode"));a.each(f,function(b,d){var e=n.head(d);q.isLi(e)?c.wrapList(d,e.parentNode.nodeName):a.each(d,function(b,c){a(c).css("marginLeft",function(a,b){return(parseInt(b,10)||0)+25})})}),d.select()},/**
     * outdent
     */
this.outdent=function(b){var c=this,d=N.create(b).wrapBodyInlineWithPara(),e=d.nodes(q.isPara,{includeAncestor:!0}),f=n.clusterBy(e,m.peq2("parentNode"));a.each(f,function(b,d){var e=n.head(d);q.isLi(e)?c.releaseList([d]):a.each(d,function(b,c){a(c).css("marginLeft",function(a,b){return b=parseInt(b,10)||0,b>25?b-25:""})})}),d.select()},/**
     * toggle list
     *
     * @param {String} listName - OL or UL
     */
this.toggleList=function(c,d){var e=N.create(d).wrapBodyInlineWithPara(),f=e.nodes(q.isPara,{includeAncestor:!0}),g=e.paraBookmark(f),h=n.clusterBy(f,m.peq2("parentNode"));
// paragraph to list
if(n.find(f,q.isPurePara)){var i=[];a.each(h,function(a,d){i=i.concat(b.wrapList(d,c))}),f=i}else{var j=e.nodes(q.isList,{includeAncestor:!0}).filter(function(b){return!a.nodeName(b,c)});j.length?a.each(j,function(a,b){q.replace(b,c)}):f=this.releaseList(h,!0)}N.createFromParaBookmark(g,f).select()},/**
     * @param {Node[]} paras
     * @param {String} listName
     * @return {Node[]}
     */
this.wrapList=function(a,b){var c=n.head(a),d=n.last(a),e=q.isList(c.previousSibling)&&c.previousSibling,f=q.isList(d.nextSibling)&&d.nextSibling,g=e||q.insertAfter(q.create(b||"UL"),d);
// P to LI
// append to list(<ul>, <ol>)
return a=a.map(function(a){return q.isPurePara(a)?q.replace(a,"LI"):a}),q.appendChildNodes(g,a),f&&(q.appendChildNodes(g,n.from(f.childNodes)),q.remove(f)),a},/**
     * @method releaseList
     *
     * @param {Array[]} clustereds
     * @param {Boolean} isEscapseToBody
     * @return {Node[]}
     */
this.releaseList=function(b,c){var d=[];return a.each(b,function(b,e){var f=n.head(e),g=n.last(e),h=c?q.lastAncestor(f,q.isList):f.parentNode,i=h.childNodes.length>1?q.splitTree(h,{node:g.parentNode,offset:q.position(g)+1},{isSkipPaddingBlankHTML:!0}):null,j=q.splitTree(h,{node:f.parentNode,offset:q.position(f)},{isSkipPaddingBlankHTML:!0});e=c?q.listDescendant(j,q.isLi):n.from(j.childNodes).filter(q.isLi),
// LI to P
!c&&q.isList(h.parentNode)||(e=e.map(function(a){return q.replace(a,"P")})),a.each(n.from(e).reverse(),function(a,b){q.insertAfter(b,h)});
// remove empty lists
var k=n.compact([h,j,i]);a.each(k,function(b,c){var d=[c].concat(q.listDescendant(c,q.isList));a.each(d.reverse(),function(a,b){q.nodeLength(b)||q.remove(b,!0)})}),d=d.concat(e)}),d}},S=function(){
// a Bullet instance to toggle lists off
var b=new R;/**
     * insert tab
     *
     * @param {WrappedRange} rng
     * @param {Number} tabsize
     */
this.insertTab=function(a,b){var c=q.createText(new Array(b+1).join(q.NBSP_CHAR));a=a.deleteContents(),a.insertNode(c,!0),a=N.create(c,b),a.select()},/**
     * insert paragraph
     */
this.insertParagraph=function(c){var d=N.create(c);
// deleteContents on range.
d=d.deleteContents(),
// Wrap range if it needs to be wrapped by paragraph
d=d.wrapBodyInlineWithPara();
// finding paragraph
var e,f=q.ancestor(d.sc,q.isPara);
// on paragraph: split paragraph
if(f){
// if it is an empty line with li
if(q.isEmpty(f)&&q.isLi(f))
// toogle UL/OL and escape
return void b.toggleList(f.parentNode.nodeName);if(q.isEmpty(f)&&q.isPara(f)&&q.isBlockquote(f.parentNode))
// escape blockquote
q.insertAfter(f,f.parentNode),e=f;else{e=q.splitTree(f,d.getStartPoint());var g=q.listDescendant(f,q.isEmptyAnchor);g=g.concat(q.listDescendant(e,q.isEmptyAnchor)),a.each(g,function(a,b){q.remove(b)}),
// replace empty heading, pre or custom-made styleTag with P tag
(q.isHeading(e)||q.isPre(e)||q.isCustomStyleTag(e))&&q.isEmpty(e)&&(e=q.replace(e,"p"))}}else{var h=d.sc.childNodes[d.so];e=a(q.emptyPara)[0],h?d.sc.insertBefore(e,h):d.sc.appendChild(e)}N.create(e,0).normalize().select().scrollIntoView(c)}},T=function(a,b,c,d){
//////////////////////////////////////////////
// Private functions
//////////////////////////////////////////////
/**
     * Set the startPoint of action.
     */
function e(){return!a||!a.tagName||"td"!==a.tagName.toLowerCase()&&"th"!==a.tagName.toLowerCase()?void console.error("Impossible to identify start Cell point.",a):(o.colPos=a.cellIndex,a.parentElement&&a.parentElement.tagName&&"tr"===a.parentElement.tagName.toLowerCase()?void(o.rowPos=a.parentElement.rowIndex):void console.error("Impossible to identify start Row point.",a))}/**
     * Define virtual table position info object.
     * 
     * @param {int} rowIndex Index position in line of virtual table.
     * @param {int} cellIndex Index position in column of virtual table.
     * @param {object} baseRow Row affected by this position.
     * @param {object} baseCell Cell affected by this position.
     * @param {bool} isSpan Inform if it is an span cell/row.
     */
function f(a,b,c,d,e,f,g){var h={baseRow:c,baseCell:d,isRowSpan:e,isColSpan:f,isVirtual:g};p[a]||(p[a]=[]),p[a][b]=h}/**
     * Create action cell object.
     * 
     * @param {object} virtualTableCellObj Object of specific position on virtual table.
     * @param {enum} resultAction Action to be applied in that item.
     */
function g(a,b,c,d){return{baseCell:a.baseCell,action:b,virtualTable:{rowIndex:c,cellIndex:d}}}/**
     * Recover free index of row to append Cell.
     * 
     * @param {int} rowIndex Index of row to find free space.
     * @param {int} cellIndex Index of cell to find free space in table.
     */
function h(a,b){if(!p[a])return b;if(!p[a][b])return b;for(var c=b;p[a][c];)if(c++,!p[a][c])return c}/**
     * Recover info about row and cell and add information to virtual table.
     * 
     * @param {object} row Row to recover information.
     * @param {object} cell Cell to recover information.
     */
function i(a,b){var c=h(a.rowIndex,b.cellIndex),d=b.colSpan>1,e=b.rowSpan>1,g=a.rowIndex===o.rowPos&&b.cellIndex===o.colPos;f(a.rowIndex,c,a,b,e,d,!1);
// Add span rows to virtual Table.
var i=b.attributes.rowSpan?parseInt(b.attributes.rowSpan.value,10):0;if(i>1)for(var k=1;k<i;k++){var l=a.rowIndex+k;j(l,c,b,g),f(l,c,a,b,!0,d,!0)}
// Add span cols to virtual table.
var m=b.attributes.colSpan?parseInt(b.attributes.colSpan.value,10):0;if(m>1)for(var n=1;n<m;n++){var p=h(a.rowIndex,c+n);j(a.rowIndex,p,b,g),f(a.rowIndex,p,a,b,e,!0,!0)}}/**
     * Process validation and adjust of start point if needed
     * 
     * @param {int} rowIndex 
     * @param {int} cellIndex 
     * @param {object} cell 
     * @param {bool} isSelectedCell 
     */
function j(a,b,c,d){a===o.rowPos&&o.colPos>=c.cellIndex&&c.cellIndex<=b&&!d&&o.colPos++}/**
     * Create virtual table of cells with all cells, including span cells.
     */
function k(){for(var a=d.rows,b=0;b<a.length;b++)for(var c=a[b].cells,e=0;e<c.length;e++)i(a[b],c[e])}/**
     * Get action to be applied on the cell.
     * 
     * @param {object} cell virtual table cell to apply action
     */
function l(a){switch(b){case T.where.Column:if(a.isColSpan)return T.resultAction.SubtractSpanCount;break;case T.where.Row:if(!a.isVirtual&&a.isRowSpan)return T.resultAction.AddCell;if(a.isRowSpan)return T.resultAction.SubtractSpanCount}return T.resultAction.RemoveCell}/**
     * Get action to be applied on the cell.
     * 
     * @param {object} cell virtual table cell to apply action
     */
function m(a){switch(b){case T.where.Column:if(a.isColSpan)return T.resultAction.SumSpanCount;if(a.isRowSpan&&a.isVirtual)return T.resultAction.Ignore;break;case T.where.Row:if(a.isRowSpan)return T.resultAction.SumSpanCount;if(a.isColSpan&&a.isVirtual)return T.resultAction.Ignore}return T.resultAction.AddCell}function n(){e(),k()}var o={colPos:0,rowPos:0},p=[],q=[];
//////////////////////////////////////////////
// Public functions
//////////////////////////////////////////////
/**
     * Recover array os what to do in table.
     */
this.getActionList=function(){for(var a=b===T.where.Row?o.rowPos:-1,d=b===T.where.Column?o.colPos:-1,e=0,f=!0;f;){var h=a>=0?a:e,i=d>=0?d:e,j=p[h];if(!j)return f=!1,q;var k=j[i];if(!k)return f=!1,q;
// Define action to be applied in this cell
var n=T.resultAction.Ignore;switch(c){case T.requestAction.Add:n=m(k);break;case T.requestAction.Delete:n=l(k)}q.push(g(k,n,h,i)),e++}return q},n()};/**
  * 
  * Where action occours enum.
  */
T.where={Row:0,Column:1},/**
  * 
  * Requested action to apply enum.
  */
T.requestAction={Add:0,Delete:1},/**
  * 
  * Result action to be executed enum.
  */
T.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4};/**
   * 
   * @class editing.Table
   *
   * Table
   *
   */
var U,V=function(){/**
     * handle tab key
     *
     * @param {WrappedRange} rng
     * @param {Boolean} isShift
     */
this.tab=function(a,b){var c=q.ancestor(a.commonAncestor(),q.isCell),d=q.ancestor(c,q.isTable),e=q.listDescendant(d,q.isCell),f=n[b?"prev":"next"](e,c);f&&N.create(f,0).select()},/**
     * Add a new row
     *
     * @param {WrappedRange} rng
     * @param {String} position (top/bottom)
     * @return {Node}
     */
this.addRow=function(b,c){for(var d=q.ancestor(b.commonAncestor(),q.isCell),e=a(d).closest("tr"),f=this.recoverAttributes(e),g=a("<tr"+f+"></tr>"),h=new T(d,T.where.Row,T.requestAction.Add,a(e).closest("table")[0]),i=h.getActionList(),j=0;j<i.length;j++){var k=i[j],l=this.recoverAttributes(k.baseCell);switch(k.action){case T.resultAction.AddCell:g.append("<td"+l+">"+q.blank+"</td>");break;case T.resultAction.SumSpanCount:if("top"===c){var m=k.baseCell.parent,n=(m?k.baseCell.closest("tr").rowIndex:0)<=e[0].rowIndex;if(n){var o=a("<div></div>").append(a("<td"+l+">"+q.blank+"</td>").removeAttr("rowspan")).html();g.append(o);break}}var p=parseInt(k.baseCell.rowSpan,10);p++,k.baseCell.setAttribute("rowSpan",p)}}if("top"===c)e.before(g);else{var r=d.rowSpan>1;if(r){var s=e[0].rowIndex+(d.rowSpan-2);return void a(a(e).parent().find("tr")[s]).after(a(g))}e.after(g)}},/**
     * Add a new col
     *
     * @param {WrappedRange} rng
     * @param {String} position (left/right)
     * @return {Node}
     */
this.addCol=function(b,c){var d=q.ancestor(b.commonAncestor(),q.isCell),e=a(d).closest("tr"),f=a(e).siblings();f.push(e);for(var g=new T(d,T.where.Column,T.requestAction.Add,a(e).closest("table")[0]),h=g.getActionList(),i=0;i<h.length;i++){var j=h[i],k=this.recoverAttributes(j.baseCell);switch(j.action){case T.resultAction.AddCell:"right"===c?a(j.baseCell).after("<td"+k+">"+q.blank+"</td>"):a(j.baseCell).before("<td"+k+">"+q.blank+"</td>");break;case T.resultAction.SumSpanCount:if("right"===c){var l=parseInt(j.baseCell.colSpan,10);l++,j.baseCell.setAttribute("colSpan",l)}else a(j.baseCell).before("<td"+k+">"+q.blank+"</td>")}}},/*
    * Copy attributes from element.
    *
    * @param {object} Element to recover attributes.
    * @return {string} Copied string elements.
    */
this.recoverAttributes=function(a){var b="";if(!a)return b;for(var c=a.attributes||[],d=0;d<c.length;d++)"id"!==c[d].name.toLowerCase()&&c[d].specified&&(b+=" "+c[d].name+"='"+c[d].value+"'");return b},/**
     * Delete current row
     *
     * @param {WrappedRange} rng
     * @return {Node}
     */
this.deleteRow=function(b){for(var c=q.ancestor(b.commonAncestor(),q.isCell),d=a(c).closest("tr"),e=d.children("td, th").index(a(c)),f=d[0].rowIndex,g=new T(c,T.where.Row,T.requestAction.Delete,a(d).closest("table")[0]),h=g.getActionList(),i=0;i<h.length;i++)if(h[i]){var j=h[i].baseCell,k=h[i].virtualTable,l=j.rowSpan&&j.rowSpan>1,m=l?parseInt(j.rowSpan,10):0;switch(h[i].action){case T.resultAction.Ignore:continue;case T.resultAction.AddCell:var n=d.next("tr")[0];if(!n)continue;var o=d[0].cells[e];l&&(m>2?(m--,n.insertBefore(o,n.cells[e]),n.cells[e].setAttribute("rowSpan",m),n.cells[e].innerHTML=""):2===m&&(n.insertBefore(o,n.cells[e]),n.cells[e].removeAttribute("rowSpan"),n.cells[e].innerHTML=""));continue;case T.resultAction.SubtractSpanCount:l&&(m>2?(m--,j.setAttribute("rowSpan",m),k.rowIndex!==f&&j.cellIndex===e&&(j.innerHTML="")):2===m&&(j.removeAttribute("rowSpan"),k.rowIndex!==f&&j.cellIndex===e&&(j.innerHTML="")));continue;case T.resultAction.RemoveCell:
// Do not need remove cell because row will be deleted.
continue}}d.remove()},/**
     * Delete current col
     *
     * @param {WrappedRange} rng
     * @return {Node}
     */
this.deleteCol=function(b){for(var c=q.ancestor(b.commonAncestor(),q.isCell),d=a(c).closest("tr"),e=d.children("td, th").index(a(c)),f=new T(c,T.where.Column,T.requestAction.Delete,a(d).closest("table")[0]),g=f.getActionList(),h=0;h<g.length;h++)if(g[h])switch(g[h].action){case T.resultAction.Ignore:continue;case T.resultAction.SubtractSpanCount:var i=g[h].baseCell,j=i.colSpan&&i.colSpan>1;if(j){var k=i.colSpan?parseInt(i.colSpan,10):0;k>2?(k--,i.setAttribute("colSpan",k),i.cellIndex===e&&(i.innerHTML="")):2===k&&(i.removeAttribute("colSpan"),i.cellIndex===e&&(i.innerHTML=""))}continue;case T.resultAction.RemoveCell:q.remove(g[h].baseCell,!0);continue}},/**
     * create empty table element
     *
     * @param {Number} rowCount
     * @param {Number} colCount
     * @return {Node}
     */
this.createTable=function(b,c,d){for(var e,f=[],g=0;g<b;g++)f.push("<td>"+q.blank+"</td>");e=f.join("");for(var h,i=[],j=0;j<c;j++)i.push("<tr>"+e+"</tr>");h=i.join("");var k=a("<table>"+h+"</table>");return d&&d.tableClassName&&k.addClass(d.tableClassName),k[0]},/**
     * Delete current table
     *
     * @param {WrappedRange} rng
     * @return {Node}
     */
this.deleteTable=function(b){var c=q.ancestor(b.commonAncestor(),q.isCell);a(c).closest("table").remove()}},W="bogus",X=function(b){var c=this,d=b.layoutInfo.note,e=b.layoutInfo.editor,f=b.layoutInfo.editable,g=b.options,h=g.langInfo,i=f[0],j=null,k=new Q,o=new V,p=new S,r=new R,s=new P(f);this.initialize=function(){
// bind custom events
f.on("keydown",function(a){a.keyCode===M.code.ENTER&&b.triggerEvent("enter",a),b.triggerEvent("keydown",a),a.isDefaultPrevented()||(g.shortcuts?c.handleKeyMap(a):c.preventDefaultEditableShortCuts(a))}).on("keyup",function(a){b.triggerEvent("keyup",a)}).on("focus",function(a){b.triggerEvent("focus",a)}).on("blur",function(a){b.triggerEvent("blur",a)}).on("mousedown",function(a){b.triggerEvent("mousedown",a)}).on("mouseup",function(a){b.triggerEvent("mouseup",a)}).on("scroll",function(a){b.triggerEvent("scroll",a)}).on("paste",function(a){b.triggerEvent("paste",a)}),
// init content before set event
f.html(q.html(d)||q.emptyPara);
// [workaround] IE doesn't have input events for contentEditable
// - see: https://goo.gl/4bfIvA
var a=l.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";f.on(a,m.debounce(function(){b.triggerEvent("change",f.html())},100)),e.on("focusin",function(a){b.triggerEvent("focusin",a)}).on("focusout",function(a){b.triggerEvent("focusout",a)}),g.airMode||(g.width&&e.outerWidth(g.width),g.height&&f.outerHeight(g.height),g.maxHeight&&f.css("max-height",g.maxHeight),g.minHeight&&f.css("min-height",g.minHeight)),s.recordUndo()},this.destroy=function(){f.off()},this.handleKeyMap=function(a){var c=g.keyMap[l.isMac?"mac":"pc"],d=[];a.metaKey&&d.push("CMD"),a.ctrlKey&&!a.altKey&&d.push("CTRL"),a.shiftKey&&d.push("SHIFT");var e=M.nameFromCode[a.keyCode];e&&d.push(e);var f=c[d.join("+")];f?(a.preventDefault(),b.invoke(f)):M.isEdit(a.keyCode)&&this.afterCommand()},this.preventDefaultEditableShortCuts=function(a){
// B(Bold, 66) / I(Italic, 73) / U(Underline, 85)
(a.ctrlKey||a.metaKey)&&n.contains([66,73,85],a.keyCode)&&a.preventDefault()},/**
     * create range
     * @return {WrappedRange}
     */
this.createRange=function(){return this.focus(),N.create(i)},/**
     * saveRange
     *
     * save current range
     *
     * @param {Boolean} [thenCollapse=false]
     */
this.saveRange=function(a){j=this.createRange(),a&&j.collapse().select()},/**
     * restoreRange
     *
     * restore lately range
     */
this.restoreRange=function(){j&&(j.select(),this.focus())},this.saveTarget=function(a){f.data("target",a)},this.clearTarget=function(){f.removeData("target")},this.restoreTarget=function(){return f.data("target")},/**
     * currentStyle
     *
     * current style
     * @return {Object|Boolean} unfocus
     */
this.currentStyle=function(){var a=N.create();return a&&(a=a.normalize()),a?k.current(a):k.fromNode(f)},/**
     * style from node
     *
     * @param {jQuery} $node
     * @return {Object}
     */
this.styleFromNode=function(a){return k.fromNode(a)},/**
     * undo
     */
this.undo=function(){b.triggerEvent("before.command",f.html()),s.undo(),b.triggerEvent("change",f.html())},b.memo("help.undo",h.help.undo),/**
     * redo
     */
this.redo=function(){b.triggerEvent("before.command",f.html()),s.redo(),b.triggerEvent("change",f.html())},b.memo("help.redo",h.help.redo);for(var t=this.beforeCommand=function(){b.triggerEvent("before.command",f.html()),
// keep focus on editable before command execution
c.focus()},u=this.afterCommand=function(a){s.recordUndo(),a||b.triggerEvent("change",f.html())},v=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","fontName"],w=0,x=v.length;w<x;w++)this[v[w]]=function(a){return function(b){t(),document.execCommand(a,!1,b),u(!0)}}(v[w]),b.memo("help."+v[w],h.help[v[w]]);/* jshint ignore:end */
/**
     * handle tab key
     */
this.tab=function(){var a=this.createRange();a.isCollapsed()&&a.isOnCell()?o.tab(a):(t(),p.insertTab(a,g.tabSize),u())},b.memo("help.tab",h.help.tab),/**
     * handle shift+tab key
     */
this.untab=function(){var a=this.createRange();a.isCollapsed()&&a.isOnCell()&&o.tab(a,!0)},b.memo("help.untab",h.help.untab),/**
     * run given function between beforeCommand and afterCommand
     */
this.wrapCommand=function(a){return function(){t(),a.apply(c,arguments),u()}},/**
     * insert paragraph
     */
this.insertParagraph=this.wrapCommand(function(){p.insertParagraph(i)}),b.memo("help.insertParagraph",h.help.insertParagraph),this.insertOrderedList=this.wrapCommand(function(){r.insertOrderedList(i)}),b.memo("help.insertOrderedList",h.help.insertOrderedList),this.insertUnorderedList=this.wrapCommand(function(){r.insertUnorderedList(i)}),b.memo("help.insertUnorderedList",h.help.insertUnorderedList),this.indent=this.wrapCommand(function(){r.indent(i)}),b.memo("help.indent",h.help.indent),this.outdent=this.wrapCommand(function(){r.outdent(i)}),b.memo("help.outdent",h.help.outdent),/**
     * insert image
     *
     * @param {String} src
     * @param {String|Function} param
     * @return {Promise}
     */
this.insertImage=function(a,c){return O.createImage(a,c).then(function(a){t(),"function"==typeof c?c(a):("string"==typeof c&&a.attr("data-filename",c),a.css("width",Math.min(f.width(),a.width()))),a.show(),N.create(i).insertNode(a[0]),N.createFromNodeAfter(a[0]).select(),u()}).fail(function(a){b.triggerEvent("image.upload.error",a)})},/**
     * insertImages
     * @param {File[]} files
     */
this.insertImages=function(d){a.each(d,function(a,d){var e=d.name;g.maximumImageFileSize&&g.maximumImageFileSize<d.size?b.triggerEvent("image.upload.error",h.image.maximumFileSizeError):O.readFileAsDataURL(d).then(function(a){return c.insertImage(a,e)}).fail(function(){b.triggerEvent("image.upload.error")})})},/**
     * insertImagesOrCallback
     * @param {File[]} files
     */
this.insertImagesOrCallback=function(a){var c=g.callbacks;
// If onImageUpload options setted
c.onImageUpload?b.triggerEvent("image.upload",a):this.insertImages(a)},/**
     * insertNode
     * insert node
     * @param {Node} node
     */
this.insertNode=this.wrapCommand(function(a){var b=this.createRange();b.insertNode(a),N.createFromNodeAfter(a).select()}),/**
     * insert text
     * @param {String} text
     */
this.insertText=this.wrapCommand(function(a){var b=this.createRange(),c=b.insertNode(q.createText(a));N.create(c,q.nodeLength(c)).select()}),/**
     * return selected plain text
     * @return {String} text
     */
this.getSelectedText=function(){var a=this.createRange();
// if range on anchor, expand range with anchor
return a.isOnAnchor()&&(a=N.createFromNode(q.ancestor(a.sc,q.isAnchor))),a.toString()},/**
     * paste HTML
     * @param {String} markup
     */
this.pasteHTML=this.wrapCommand(function(a){var b=this.createRange().pasteHTML(a);N.createFromNodeAfter(n.last(b)).select()}),/**
     * formatBlock
     *
     * @param {String} tagName
     */
this.formatBlock=this.wrapCommand(function(a,c){var d=b.options.callbacks.onApplyCustomStyle;d?d.call(this,c,b,this.onFormatBlock):this.onFormatBlock(a)}),this.onFormatBlock=function(a){
// [workaround] for MSIE, IE need `<`
a=l.isMSIE?"<"+a+">":a,document.execCommand("FormatBlock",!1,a)},this.formatPara=function(){this.formatBlock("P")},b.memo("help.formatPara",h.help.formatPara);/* jshint ignore:start */
for(var w=1;w<=6;w++)this["formatH"+w]=function(a){return function(){this.formatBlock("H"+a)}}(w),b.memo("help.formatH"+w,h.help["formatH"+w]);/* jshint ignore:end */
/**
     * fontSize
     *
     * @param {String} value - px
     */
this.fontSize=function(b){var c=this.createRange();if(c&&c.isCollapsed()){var d=k.styleNodes(c),e=n.head(d);a(d).css({"font-size":b+"px"}),
// [workaround] added styled bogus span for style
//  - also bogus character needed for cursor position
e&&!q.nodeLength(e)&&(e.innerHTML=q.ZERO_WIDTH_NBSP_CHAR,N.createFromNodeAfter(e.firstChild).select(),f.data(W,e))}else t(),a(k.styleNodes(c)).css({"font-size":b+"px"}),u()},/**
     * insert horizontal rule
     */
this.insertHorizontalRule=this.wrapCommand(function(){var a=this.createRange().insertNode(q.create("HR"));a.nextSibling&&N.create(a.nextSibling,0).normalize().select()}),b.memo("help.insertHorizontalRule",h.help.insertHorizontalRule),/**
     * remove bogus node and character
     */
this.removeBogus=function(){var a=f.data(W);if(a){var b=n.find(n.from(a.childNodes),q.isText),c=b.nodeValue.indexOf(q.ZERO_WIDTH_NBSP_CHAR);c!==-1&&b.deleteData(c,1),q.isEmpty(a)&&q.remove(a),f.removeData(W)}},/**
     * lineHeight
     * @param {String} value
     */
this.lineHeight=this.wrapCommand(function(a){k.stylePara(this.createRange(),{lineHeight:a})}),/**
     * unlink
     *
     * @type command
     */
this.unlink=function(){var a=this.createRange();if(a.isOnAnchor()){var b=q.ancestor(a.sc,q.isAnchor);a=N.createFromNode(b),a.select(),t(),document.execCommand("unlink"),u()}},/**
     * create link (command)
     *
     * @param {Object} linkInfo
     */
this.createLink=this.wrapCommand(function(b){var c=b.url,d=b.text,e=b.isNewWindow,f=b.range||this.createRange(),h=f.toString()!==d;
// handle spaced urls from input
"string"==typeof c&&(c=c.trim()),c=g.onCreateLink?g.onCreateLink(c):/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(c)?c:"http://"+c;var i=[];if(h){f=f.deleteContents();var j=f.insertNode(a("<A>"+d+"</A>")[0]);i.push(j)}else i=k.styleNodes(f,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});a.each(i,function(b,d){a(d).attr("href",c),e?a(d).attr("target","_blank"):a(d).removeAttr("target")});var l=N.createFromNodeBefore(n.head(i)),m=l.getStartPoint(),o=N.createFromNodeAfter(n.last(i)),p=o.getEndPoint();N.create(m.node,m.offset,p.node,p.offset).select()}),/**
     * returns link info
     *
     * @return {Object}
     * @return {WrappedRange} return.range
     * @return {String} return.text
     * @return {Boolean} [return.isNewWindow=true]
     * @return {String} [return.url=""]
     */
this.getLinkInfo=function(){var b=this.createRange().expand(q.isAnchor),c=a(n.head(b.nodes(q.isAnchor))),d={range:b,text:b.toString(),url:c.length?c.attr("href"):""};
// Define isNewWindow when anchor exists.
return c.length&&(d.isNewWindow="_blank"===c.attr("target")),d},/**
     * setting color
     *
     * @param {Object} sObjColor  color code
     * @param {String} sObjColor.foreColor foreground color
     * @param {String} sObjColor.backColor background color
     */
this.color=this.wrapCommand(function(a){var b=a.foreColor,c=a.backColor;b&&document.execCommand("foreColor",!1,b),c&&document.execCommand("backColor",!1,c)}),/**
     * Set foreground color
     *
     * @param {String} colorCode foreground color code
     */
this.foreColor=this.wrapCommand(function(a){document.execCommand("styleWithCSS",!1,!0),document.execCommand("foreColor",!1,a)}),/**
     * insert Table
     *
     * @param {String} dimension of table (ex : "5x5")
     */
this.insertTable=this.wrapCommand(function(a){var b=a.split("x"),c=this.createRange().deleteContents();c.insertNode(o.createTable(b[0],b[1],g))}),/**
     * @method addRow
     *
     *
     */
this.addRow=function(a){var b=this.createRange(f);b.isCollapsed()&&b.isOnCell()&&(t(),o.addRow(b,a),u())},/**
     * @method addCol
     *
     *
     */
this.addCol=function(a){var b=this.createRange(f);b.isCollapsed()&&b.isOnCell()&&(t(),o.addCol(b,a),u())},/**
     * @method deleteRow
     *
     *
     */
this.deleteRow=function(){var a=this.createRange(f);a.isCollapsed()&&a.isOnCell()&&(t(),o.deleteRow(a),u())},/**
     * @method deleteCol
     *
     *
     */
this.deleteCol=function(){var a=this.createRange(f);a.isCollapsed()&&a.isOnCell()&&(t(),o.deleteCol(a),u())},/**
     * @method deleteTable
     *
     *
     */
this.deleteTable=function(){var a=this.createRange(f);a.isCollapsed()&&a.isOnCell()&&(t(),o.deleteTable(a),u())},/**
     * float me
     *
     * @param {String} value
     */
this.floatMe=this.wrapCommand(function(b){var c=a(this.restoreTarget());c.toggleClass("note-float-left","left"===b),c.toggleClass("note-float-right","right"===b),c.css("float",b)}),/**
     * resize overlay element
     * @param {String} value
     */
this.resize=this.wrapCommand(function(b){var c=a(this.restoreTarget());c.css({width:100*b+"%",height:""})}),/**
     * @param {Position} pos
     * @param {jQuery} $target - target element
     * @param {Boolean} [bKeepRatio] - keep ratio
     */
this.resizeTo=function(a,b,c){var d;if(c){var e=a.y/a.x,f=b.data("ratio");d={width:f>e?a.x:a.y/f,height:f>e?a.x*f:a.y}}else d={width:a.x,height:a.y};b.css(d)},/**
     * remove media object
     */
this.removeMedia=this.wrapCommand(function(){var c=a(this.restoreTarget()).detach();b.triggerEvent("media.delete",c,f)}),/**
     * returns whether editable area has focus or not.
     */
this.hasFocus=function(){return f.is(":focus")},/**
     * set focus
     */
this.focus=function(){
// [workaround] Screen will move when page is scolled in IE.
//  - do focus when not focused
this.hasFocus()||f.focus()},/**
     * returns whether contents is empty or not.
     * @return {Boolean}
     */
this.isEmpty=function(){return q.isEmpty(f[0])||q.emptyPara===f.html()},/**
     * Removes all contents and restores the editable instance to an _emptyPara_.
     */
this.empty=function(){b.invoke("code",q.emptyPara)}},Y=function(b){var c=this,d=b.layoutInfo.editable;this.events={"summernote.keydown":function(a,d){c.needKeydownHook()&&(d.ctrlKey||d.metaKey)&&d.keyCode===M.code.V&&(b.invoke("editor.saveRange"),c.$paste.focus(),setTimeout(function(){c.pasteByHook()},0))}},this.needKeydownHook=function(){return l.isMSIE&&l.browserVersion>10||l.isFF},this.initialize=function(){
// [workaround] getting image from clipboard
//  - IE11 and Firefox: CTRL+v hook
//  - Webkit: event.clipboardData
this.needKeydownHook()?(this.$paste=a('<div tabindex="-1" />').attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),d.before(this.$paste),this.$paste.on("paste",function(a){b.triggerEvent("paste",a)})):d.on("paste",this.pasteByEvent)},this.destroy=function(){this.needKeydownHook()&&(this.$paste.remove(),this.$paste=null)},this.pasteByHook=function(){var c=this.$paste[0].firstChild,d=c&&c.src;if(q.isImg(c)&&0===d.indexOf("data:")){for(var e=atob(c.src.split(",")[1]),f=new Uint8Array(e.length),g=0;g<e.length;g++)f[g]=e.charCodeAt(g);var h=new Blob([f],{type:"image/png"});h.name="clipboard.png",b.invoke("editor.restoreRange"),b.invoke("editor.focus"),b.invoke("editor.insertImagesOrCallback",[h])}else{var i=a("<div />").html(this.$paste.html()).html();b.invoke("editor.restoreRange"),b.invoke("editor.focus"),i&&b.invoke("editor.pasteHTML",i)}this.$paste.empty()},/**
     * paste by clipboard event
     *
     * @param {Event} event
     */
this.pasteByEvent=function(a){var c=a.originalEvent.clipboardData;if(c&&c.items&&c.items.length){var d=n.head(c.items);"file"===d.kind&&d.type.indexOf("image/")!==-1&&b.invoke("editor.insertImagesOrCallback",[d.getAsFile()]),b.invoke("editor.afterCommand")}}},Z=function(b){var c=a(document),d=b.layoutInfo.editor,e=b.layoutInfo.editable,f=b.options,g=f.langInfo,h={},i=a(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo(d),j=function(){Object.keys(h).forEach(function(a){c.off(a.substr(2).toLowerCase(),h[a])}),h={}};/**
     * attach Drag and Drop Events
     */
this.initialize=function(){f.disableDragAndDrop?(
// prevent default drop event
h.onDrop=function(a){a.preventDefault()},c.on("drop",h.onDrop)):this.attachDragAndDropEvent()},/**
     * attach Drag and Drop Events
     */
this.attachDragAndDropEvent=function(){var f=a(),j=i.find(".note-dropzone-message");h.onDragenter=function(a){var c=b.invoke("codeview.isActivated"),e=d.width()>0&&d.height()>0;c||f.length||!e||(d.addClass("dragover"),i.width(d.width()),i.height(d.height()),j.text(g.image.dragImageHere)),f=f.add(a.target)},h.onDragleave=function(a){f=f.not(a.target),f.length||d.removeClass("dragover")},h.onDrop=function(){f=a(),d.removeClass("dragover")},
// show dropzone on dragenter when dragging a object to document
// -but only if the editor is visible, i.e. has a positive width and height
c.on("dragenter",h.onDragenter).on("dragleave",h.onDragleave).on("drop",h.onDrop),
// change dropzone's message on hover.
i.on("dragenter",function(){i.addClass("hover"),j.text(g.image.dropImage)}).on("dragleave",function(){i.removeClass("hover"),j.text(g.image.dragImageHere)}),
// attach dropImage
i.on("drop",function(c){var d=c.originalEvent.dataTransfer;d&&d.files&&d.files.length?(c.preventDefault(),e.focus(),b.invoke("editor.insertImagesOrCallback",d.files)):a.each(d.types,function(c,e){var f=d.getData(e);e.toLowerCase().indexOf("text")>-1?b.invoke("editor.pasteHTML",f):a(f).each(function(){b.invoke("editor.insertNode",this)})})}).on("dragover",!1)},this.destroy=function(){j()}};l.hasCodeMirror&&(l.isSupportAmd?require(["codemirror"],function(a){U=a}):U=window.CodeMirror);/**
   * @class Codeview
   */
var $=function(a){var b=a.layoutInfo.editor,c=a.layoutInfo.editable,d=a.layoutInfo.codable,e=a.options;this.sync=function(){var a=this.isActivated();a&&l.hasCodeMirror&&d.data("cmEditor").save()},/**
     * @return {Boolean}
     */
this.isActivated=function(){return b.hasClass("codeview")},/**
     * toggle codeview
     */
this.toggle=function(){this.isActivated()?this.deactivate():this.activate(),a.triggerEvent("codeview.toggled")},/**
     * activate code view
     */
this.activate=function(){
// activate CodeMirror as codable
if(d.val(q.html(c,e.prettifyHtml)),d.height(c.height()),a.invoke("toolbar.updateCodeview",!0),b.addClass("codeview"),d.focus(),l.hasCodeMirror){var f=U.fromTextArea(d[0],e.codemirror);
// CodeMirror TernServer
if(e.codemirror.tern){var g=new U.TernServer(e.codemirror.tern);f.ternServer=g,f.on("cursorActivity",function(a){g.updateArgHints(a)})}
// CodeMirror hasn't Padding.
f.setSize(null,c.outerHeight()),d.data("cmEditor",f)}},/**
     * deactivate code view
     */
this.deactivate=function(){
// deactivate CodeMirror as codable
if(l.hasCodeMirror){var f=d.data("cmEditor");d.val(f.getValue()),f.toTextArea()}var g=q.value(d,e.prettifyHtml)||q.emptyPara,h=c.html()!==g;c.html(g),c.height(e.height?d.height():"auto"),b.removeClass("codeview"),h&&a.triggerEvent("change",c.html(),c),c.focus(),a.invoke("toolbar.updateCodeview",!1)},this.destroy=function(){this.isActivated()&&this.deactivate()}},_=24,aa=function(b){var c=a(document),d=b.layoutInfo.statusbar,e=b.layoutInfo.editable,f=b.options;this.initialize=function(){return f.airMode||f.disableResizeEditor?void this.destroy():void d.on("mousedown",function(a){a.preventDefault(),a.stopPropagation();var b=e.offset().top-c.scrollTop(),d=function(a){var c=a.clientY-(b+_);c=f.minheight>0?Math.max(c,f.minheight):c,c=f.maxHeight>0?Math.min(c,f.maxHeight):c,e.height(c)};c.on("mousemove",d).one("mouseup",function(){c.off("mousemove",d)})})},this.destroy=function(){d.off(),d.remove()}},ba=function(b){var c=this,d=b.layoutInfo.editor,e=b.layoutInfo.toolbar,f=b.layoutInfo.editable,g=b.layoutInfo.codable,h=a(window),i=a("html, body");this.resizeTo=function(a){f.css("height",a.h),g.css("height",a.h),g.data("cmeditor")&&g.data("cmeditor").setsize(null,a.h)},this.onResize=function(){c.resizeTo({h:h.height()-e.outerHeight()})},/**
     * toggle fullscreen
     */
this.toggle=function(){d.toggleClass("fullscreen"),this.isFullscreen()?(f.data("orgHeight",f.css("height")),h.on("resize",this.onResize).trigger("resize"),i.css("overflow","hidden")):(h.off("resize",this.onResize),this.resizeTo({h:f.data("orgHeight")}),i.css("overflow","visible")),b.invoke("toolbar.updateFullscreen",this.isFullscreen())},this.isFullscreen=function(){return d.hasClass("fullscreen")}},ca=function(b){var c=this,d=a(document),e=b.layoutInfo.editingArea,f=b.options;this.events={"summernote.mousedown":function(a,b){c.update(b.target)&&b.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){c.update()},"summernote.disable":function(){c.hide()},"summernote.codeview.toggled":function(){c.update()}},this.initialize=function(){this.$handle=a(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',f.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',f.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(e),this.$handle.on("mousedown",function(a){if(q.isControlSizing(a.target)){a.preventDefault(),a.stopPropagation();var e=c.$handle.find(".note-control-selection").data("target"),f=e.offset(),g=d.scrollTop(),h=function(a){b.invoke("editor.resizeTo",{x:a.clientX-f.left,y:a.clientY-(f.top-g)},e,!a.shiftKey),c.update(e[0])};d.on("mousemove",h).one("mouseup",function(a){a.preventDefault(),d.off("mousemove",h),b.invoke("editor.afterCommand")}),e.data("ratio")||// original ratio.
e.data("ratio",e.height()/e.width())}}),
// Listen for scrolling on the handle overlay.
this.$handle.on("wheel",function(a){a.preventDefault(),c.update()})},this.destroy=function(){this.$handle.remove()},this.update=function(c){if(b.isDisabled())return!1;var d=q.isImg(c),e=this.$handle.find(".note-control-selection");if(b.invoke("imagePopover.update",c),d){var f=a(c),g=f.position(),h={left:g.left+parseInt(f.css("marginLeft"),10),top:g.top+parseInt(f.css("marginTop"),10)},i={w:f.outerWidth(!1),h:f.outerHeight(!1)};e.css({display:"block",left:h.left,top:h.top,width:i.w,height:i.h}).data("target",f);// save current image element.
var j=i.w+"x"+i.h;e.find(".note-control-selection-info").text(j),b.invoke("editor.saveTarget",c)}else this.hide();return d},/**
     * hide
     *
     * @param {jQuery} $handle
     */
this.hide=function(){b.invoke("editor.clearTarget"),this.$handle.children().hide()}},da=function(b){var c=this,d="http://",e=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;this.events={"summernote.keyup":function(a,b){b.isDefaultPrevented()||c.handleKeyup(b)},"summernote.keydown":function(a,b){c.handleKeydown(b)}},this.initialize=function(){this.lastWordRange=null},this.destroy=function(){this.lastWordRange=null},this.replace=function(){if(this.lastWordRange){var c=this.lastWordRange.toString(),f=c.match(e);if(f&&(f[1]||f[2])){var g=f[1]?c:d+c,h=a("<a />").html(c).attr("href",g)[0];this.lastWordRange.insertNode(h),this.lastWordRange=null,b.invoke("editor.focus")}}},this.handleKeydown=function(a){if(n.contains([M.code.ENTER,M.code.SPACE],a.keyCode)){var c=b.invoke("editor.createRange").getWordRange();this.lastWordRange=c}},this.handleKeyup=function(a){n.contains([M.code.ENTER,M.code.SPACE],a.keyCode)&&this.replace()}},ea=function(a){var b=a.layoutInfo.note;this.events={"summernote.change":function(){b.val(a.invoke("code"))}},this.shouldInitialize=function(){return q.isTextarea(b[0])}},fa=function(b){var c=this,d=b.layoutInfo.editingArea,e=b.options;this.events={"summernote.init summernote.change":function(){c.update()},"summernote.codeview.toggled":function(){c.update()}},this.shouldInitialize=function(){return!!e.placeholder},this.initialize=function(){this.$placeholder=a('<div class="note-placeholder">'),this.$placeholder.on("click",function(){b.invoke("focus")}).text(e.placeholder).prependTo(d),this.update()},this.destroy=function(){this.$placeholder.remove()},this.update=function(){var a=!b.invoke("codeview.isActivated")&&b.invoke("editor.isEmpty");this.$placeholder.toggle(a)}},ga=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.toolbar,f=b.options,g=f.langInfo,h=m.invertObject(f.keyMap[l.isMac?"mac":"pc"]),i=this.representShortcut=function(a){var b=h[a];return f.shortcuts&&b?(l.isMac&&(b=b.replace("CMD","⌘").replace("SHIFT","⇧")),b=b.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")," ("+b+")"):""};this.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.addTablePopoverButtons(),this.fontInstalledMap={}},this.destroy=function(){delete this.fontInstalledMap},this.isFontInstalled=function(a){return c.fontInstalledMap.hasOwnProperty(a)||(c.fontInstalledMap[a]=l.isFontInstalled(a)||n.contains(f.fontNamesIgnoreCheck,a)),c.fontInstalledMap[a]},this.addToolbarButtons=function(){b.memo("button.style",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents(d.icon(f.icons.magic),f),tooltip:g.style.style,data:{toggle:"dropdown"}}),d.dropdown({className:"dropdown-style",items:b.options.styleTags,template:function(a){"string"==typeof a&&(a={tag:a,title:g.style.hasOwnProperty(a)?g.style[a]:a});var b=a.tag,c=a.title,d=a.style?' style="'+a.style+'" ':"",e=a.className?' class="'+a.className+'"':"";return"<"+b+d+e+">"+c+"</"+b+">"},click:b.createInvokeHandler("editor.formatBlock")})]).render()}),b.memo("button.bold",function(){return d.button({className:"note-btn-bold",contents:d.icon(f.icons.bold),tooltip:g.font.bold+i("bold"),click:b.createInvokeHandlerAndUpdateState("editor.bold")}).render()}),b.memo("button.italic",function(){return d.button({className:"note-btn-italic",contents:d.icon(f.icons.italic),tooltip:g.font.italic+i("italic"),click:b.createInvokeHandlerAndUpdateState("editor.italic")}).render()}),b.memo("button.underline",function(){return d.button({className:"note-btn-underline",contents:d.icon(f.icons.underline),tooltip:g.font.underline+i("underline"),click:b.createInvokeHandlerAndUpdateState("editor.underline")}).render()}),b.memo("button.clear",function(){return d.button({contents:d.icon(f.icons.eraser),tooltip:g.font.clear+i("removeFormat"),click:b.createInvokeHandler("editor.removeFormat")}).render()}),b.memo("button.strikethrough",function(){return d.button({className:"note-btn-strikethrough",contents:d.icon(f.icons.strikethrough),tooltip:g.font.strikethrough+i("strikethrough"),click:b.createInvokeHandlerAndUpdateState("editor.strikethrough")}).render()}),b.memo("button.superscript",function(){return d.button({className:"note-btn-superscript",contents:d.icon(f.icons.superscript),tooltip:g.font.superscript,click:b.createInvokeHandlerAndUpdateState("editor.superscript")}).render()}),b.memo("button.subscript",function(){return d.button({className:"note-btn-subscript",contents:d.icon(f.icons.subscript),tooltip:g.font.subscript,click:b.createInvokeHandlerAndUpdateState("editor.subscript")}).render()}),b.memo("button.fontname",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents('<span class="note-current-fontname"/>',f),tooltip:g.font.name,data:{toggle:"dropdown"}}),d.dropdownCheck({className:"dropdown-fontname",checkClassName:f.icons.menuCheck,items:f.fontNames.filter(c.isFontInstalled),template:function(a){return'<span style="font-family:'+a+'">'+a+"</span>"},click:b.createInvokeHandlerAndUpdateState("editor.fontName")})]).render()}),b.memo("button.fontsize",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents('<span class="note-current-fontsize"/>',f),tooltip:g.font.size,data:{toggle:"dropdown"}}),d.dropdownCheck({className:"dropdown-fontsize",checkClassName:f.icons.menuCheck,items:f.fontSizes,click:b.createInvokeHandlerAndUpdateState("editor.fontSize")})]).render()}),b.memo("button.color",function(){return d.buttonGroup({className:"note-color",children:[d.button({className:"note-current-color-button",contents:d.icon(f.icons.font+" note-recent-color"),tooltip:g.color.recent,click:function(c){var d=a(c.currentTarget);b.invoke("editor.color",{backColor:d.attr("data-backColor"),foreColor:d.attr("data-foreColor")})},callback:function(a){var b=a.find(".note-recent-color");b.css("background-color","#FFFF00"),a.attr("data-backColor","#FFFF00")}}),d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents("",f),tooltip:g.color.more,data:{toggle:"dropdown"}}),d.dropdown({items:['<div class="note-palette">','  <div class="note-palette-title">'+g.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-light" data-event="backColor" data-value="inherit">',g.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="note-palette">','  <div class="note-palette-title">'+g.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-light" data-event="removeFormat" data-value="foreColor">',g.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>"].join(""),callback:function(b){b.find(".note-holder").each(function(){var b=a(this);b.append(d.palette({colors:f.colors,eventName:b.data("event"),tooltip:f.tooltip}).render())})},click:function(c){var d=a(c.target),e=d.data("event"),f=d.data("value");if(e&&f){var g="backColor"===e?"background-color":"color",h=d.closest(".note-color").find(".note-recent-color"),i=d.closest(".note-color").find(".note-current-color-button");h.css(g,f),i.attr("data-"+e,f),b.invoke("editor."+e,f)}}})]}).render()}),b.memo("button.ul",function(){return d.button({contents:d.icon(f.icons.unorderedlist),tooltip:g.lists.unordered+i("insertUnorderedList"),click:b.createInvokeHandler("editor.insertUnorderedList")}).render()}),b.memo("button.ol",function(){return d.button({contents:d.icon(f.icons.orderedlist),tooltip:g.lists.ordered+i("insertOrderedList"),click:b.createInvokeHandler("editor.insertOrderedList")}).render()});var e=d.button({contents:d.icon(f.icons.alignLeft),tooltip:g.paragraph.left+i("justifyLeft"),click:b.createInvokeHandler("editor.justifyLeft")}),h=d.button({contents:d.icon(f.icons.alignCenter),tooltip:g.paragraph.center+i("justifyCenter"),click:b.createInvokeHandler("editor.justifyCenter")}),j=d.button({contents:d.icon(f.icons.alignRight),tooltip:g.paragraph.right+i("justifyRight"),click:b.createInvokeHandler("editor.justifyRight")}),k=d.button({contents:d.icon(f.icons.alignJustify),tooltip:g.paragraph.justify+i("justifyFull"),click:b.createInvokeHandler("editor.justifyFull")}),l=d.button({contents:d.icon(f.icons.outdent),tooltip:g.paragraph.outdent+i("outdent"),click:b.createInvokeHandler("editor.outdent")}),n=d.button({contents:d.icon(f.icons.indent),tooltip:g.paragraph.indent+i("indent"),click:b.createInvokeHandler("editor.indent")});b.memo("button.justifyLeft",m.invoke(e,"render")),b.memo("button.justifyCenter",m.invoke(h,"render")),b.memo("button.justifyRight",m.invoke(j,"render")),b.memo("button.justifyFull",m.invoke(k,"render")),b.memo("button.outdent",m.invoke(l,"render")),b.memo("button.indent",m.invoke(n,"render")),b.memo("button.paragraph",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents(d.icon(f.icons.alignLeft),f),tooltip:g.paragraph.paragraph,data:{toggle:"dropdown"}}),d.dropdown([d.buttonGroup({className:"note-align",children:[e,h,j,k]}),d.buttonGroup({className:"note-list",children:[l,n]})])]).render()}),b.memo("button.height",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents(d.icon(f.icons.textHeight),f),tooltip:g.font.height,data:{toggle:"dropdown"}}),d.dropdownCheck({items:f.lineHeights,checkClassName:f.icons.menuCheck,className:"dropdown-line-height",click:b.createInvokeHandler("editor.lineHeight")})]).render()}),b.memo("button.table",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:d.dropdownButtonContents(d.icon(f.icons.table),f),tooltip:g.table.table,data:{toggle:"dropdown"}}),d.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(a){var d=a.find(".note-dimension-picker-mousecatcher");d.css({width:f.insertTableMaxSize.col+"em",height:f.insertTableMaxSize.row+"em"}).mousedown(b.createInvokeHandler("editor.insertTable")).on("mousemove",c.tableMoveHandler)}}).render()}),b.memo("button.link",function(){return d.button({contents:d.icon(f.icons.link),tooltip:g.link.link+i("linkDialog.show"),click:b.createInvokeHandler("linkDialog.show")}).render()}),b.memo("button.picture",function(){return d.button({contents:d.icon(f.icons.picture),tooltip:g.image.image,click:b.createInvokeHandler("imageDialog.show")}).render()}),b.memo("button.video",function(){return d.button({contents:d.icon(f.icons.video),tooltip:g.video.video,click:b.createInvokeHandler("videoDialog.show")}).render()}),b.memo("button.hr",function(){return d.button({contents:d.icon(f.icons.minus),tooltip:g.hr.insert+i("insertHorizontalRule"),click:b.createInvokeHandler("editor.insertHorizontalRule")}).render()}),b.memo("button.fullscreen",function(){return d.button({className:"btn-fullscreen",contents:d.icon(f.icons.arrowsAlt),tooltip:g.options.fullscreen,click:b.createInvokeHandler("fullscreen.toggle")}).render()}),b.memo("button.codeview",function(){return d.button({className:"btn-codeview",contents:d.icon(f.icons.code),tooltip:g.options.codeview,click:b.createInvokeHandler("codeview.toggle")}).render()}),b.memo("button.redo",function(){return d.button({contents:d.icon(f.icons.redo),tooltip:g.history.redo+i("redo"),click:b.createInvokeHandler("editor.redo")}).render()}),b.memo("button.undo",function(){return d.button({contents:d.icon(f.icons.undo),tooltip:g.history.undo+i("undo"),click:b.createInvokeHandler("editor.undo")}).render()}),b.memo("button.help",function(){return d.button({contents:d.icon(f.icons.question),tooltip:g.options.help,click:b.createInvokeHandler("helpDialog.show")}).render()})},/**
     * image : [
     *   ['imagesize', ['imageSize100', 'imageSize50', 'imageSize25']],
     *   ['float', ['floatLeft', 'floatRight', 'floatNone' ]],
     *   ['remove', ['removeMedia']]
     * ],
     */
this.addImagePopoverButtons=function(){
// Image Size Buttons
b.memo("button.imageSize100",function(){return d.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:g.image.resizeFull,click:b.createInvokeHandler("editor.resize","1")}).render()}),b.memo("button.imageSize50",function(){return d.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:g.image.resizeHalf,click:b.createInvokeHandler("editor.resize","0.5")}).render()}),b.memo("button.imageSize25",function(){return d.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:g.image.resizeQuarter,click:b.createInvokeHandler("editor.resize","0.25")}).render()}),
// Float Buttons
b.memo("button.floatLeft",function(){return d.button({contents:d.icon(f.icons.alignLeft),tooltip:g.image.floatLeft,click:b.createInvokeHandler("editor.floatMe","left")}).render()}),b.memo("button.floatRight",function(){return d.button({contents:d.icon(f.icons.alignRight),tooltip:g.image.floatRight,click:b.createInvokeHandler("editor.floatMe","right")}).render()}),b.memo("button.floatNone",function(){return d.button({contents:d.icon(f.icons.alignJustify),tooltip:g.image.floatNone,click:b.createInvokeHandler("editor.floatMe","none")}).render()}),
// Remove Buttons
b.memo("button.removeMedia",function(){return d.button({contents:d.icon(f.icons.trash),tooltip:g.image.remove,click:b.createInvokeHandler("editor.removeMedia")}).render()})},this.addLinkPopoverButtons=function(){b.memo("button.linkDialogShow",function(){return d.button({contents:d.icon(f.icons.link),tooltip:g.link.edit,click:b.createInvokeHandler("linkDialog.show")}).render()}),b.memo("button.unlink",function(){return d.button({contents:d.icon(f.icons.unlink),tooltip:g.link.unlink,click:b.createInvokeHandler("editor.unlink")}).render()})},/**
     * table : [
     *  ['add', ['addRowDown', 'addRowUp', 'addColLeft', 'addColRight']],
     *  ['delete', ['deleteRow', 'deleteCol', 'deleteTable']]
     * ],
     */
this.addTablePopoverButtons=function(){b.memo("button.addRowUp",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.rowAbove),tooltip:g.table.addRowAbove,click:b.createInvokeHandler("editor.addRow","top")}).render()}),b.memo("button.addRowDown",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.rowBelow),tooltip:g.table.addRowBelow,click:b.createInvokeHandler("editor.addRow","bottom")}).render()}),b.memo("button.addColLeft",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.colBefore),tooltip:g.table.addColLeft,click:b.createInvokeHandler("editor.addCol","left")}).render()}),b.memo("button.addColRight",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.colAfter),tooltip:g.table.addColRight,click:b.createInvokeHandler("editor.addCol","right")}).render()}),b.memo("button.deleteRow",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.rowRemove),tooltip:g.table.delRow,click:b.createInvokeHandler("editor.deleteRow")}).render()}),b.memo("button.deleteCol",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.colRemove),tooltip:g.table.delCol,click:b.createInvokeHandler("editor.deleteCol")}).render()}),b.memo("button.deleteTable",function(){return d.button({className:"btn-md",contents:d.icon(f.icons.trash),tooltip:g.table.delTable,click:b.createInvokeHandler("editor.deleteTable")}).render()})},this.build=function(a,c){for(var e=0,f=c.length;e<f;e++){for(var g=c[e],h=g[0],i=g[1],j=d.buttonGroup({className:"note-"+h}).render(),k=0,l=i.length;k<l;k++){var m=b.memo("button."+i[k]);m&&j.append("function"==typeof m?m(b):m)}j.appendTo(a)}},/**
     * @param {jQuery} [$container]
     */
this.updateCurrentStyle=function(d){var f=d||e,g=b.invoke("editor.currentStyle");if(this.updateBtnStates(f,{".note-btn-bold":function(){return"bold"===g["font-bold"]},".note-btn-italic":function(){return"italic"===g["font-italic"]},".note-btn-underline":function(){return"underline"===g["font-underline"]},".note-btn-subscript":function(){return"subscript"===g["font-subscript"]},".note-btn-superscript":function(){return"superscript"===g["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===g["font-strikethrough"]}}),g["font-family"]){var h=g["font-family"].split(",").map(function(a){return a.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}),i=n.find(h,c.isFontInstalled);f.find(".dropdown-fontname a").each(function(){var b=a(this),c=b.data("value")+""==i+"";b.toggleClass("checked",c)}),f.find(".note-current-fontname").text(i)}if(g["font-size"]){var j=g["font-size"];f.find(".dropdown-fontsize a").each(function(){var b=a(this),c=b.data("value")+""==j+"";b.toggleClass("checked",c)}),f.find(".note-current-fontsize").text(j)}if(g["line-height"]){var k=g["line-height"];f.find(".dropdown-line-height li a").each(function(){
// always compare with string to avoid creating another func.
var b=a(this).data("value")+""==k+"";this.className=b?"checked":""})}},this.updateBtnStates=function(b,c){a.each(c,function(a,c){d.toggleBtnActive(b.find(a),c())})},this.tableMoveHandler=function(b){var c,d=18,e=a(b.target.parentNode),g=e.next(),h=e.find(".note-dimension-picker-mousecatcher"),i=e.find(".note-dimension-picker-highlighted"),j=e.find(".note-dimension-picker-unhighlighted");
// HTML5 with jQuery - e.offsetX is undefined in Firefox
if(void 0===b.offsetX){var k=a(b.target).offset();c={x:b.pageX-k.left,y:b.pageY-k.top}}else c={x:b.offsetX,y:b.offsetY};var l={c:Math.ceil(c.x/d)||1,r:Math.ceil(c.y/d)||1};i.css({width:l.c+"em",height:l.r+"em"}),h.data("value",l.c+"x"+l.r),3<l.c&&l.c<f.insertTableMaxSize.col&&j.css({width:l.c+1+"em"}),3<l.r&&l.r<f.insertTableMaxSize.row&&j.css({height:l.r+1+"em"}),g.html(l.c+" x "+l.r)}},ha=function(b){var c=a.summernote.ui,d=b.layoutInfo.note,e=b.layoutInfo.editor,f=b.layoutInfo.toolbar,g=b.options;this.shouldInitialize=function(){return!g.airMode},this.initialize=function(){g.toolbar=g.toolbar||[],g.toolbar.length?b.invoke("buttons.build",f,g.toolbar):f.hide(),g.toolbarContainer&&f.appendTo(g.toolbarContainer),this.changeContainer(!1),d.on("summernote.keyup summernote.mouseup summernote.change",function(){b.invoke("buttons.updateCurrentStyle")}),b.invoke("buttons.updateCurrentStyle")},this.destroy=function(){f.children().remove()},this.changeContainer=function(a){a?f.prependTo(e):g.toolbarContainer&&f.appendTo(g.toolbarContainer)},this.updateFullscreen=function(a){c.toggleBtnActive(f.find(".btn-fullscreen"),a),this.changeContainer(a)},this.updateCodeview=function(a){c.toggleBtnActive(f.find(".btn-codeview"),a),a?this.deactivate():this.activate()},this.activate=function(a){var b=f.find("button");a||(b=b.not(".btn-codeview")),c.toggleBtn(b,!0)},this.deactivate=function(a){var b=f.find("button");a||(b=b.not(".btn-codeview")),c.toggleBtn(b,!1)}},ia=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.editor,f=b.options,g=f.langInfo;this.initialize=function(){var b=f.dialogsInBody?a(document.body):e,c='<div class="form-group note-form-group"><label class="note-form-label">'+g.link.textToDisplay+'</label><input class="note-link-text form-control  note-form-control  note-input" type="text" /></div><div class="form-group note-form-group"><label class="note-form-label">'+g.link.url+'</label><input class="note-link-url form-control note-form-control note-input" type="text" value="http://" /></div>'+(f.disableLinkTarget?"":a("<div/>").append(d.checkbox({id:"sn-checkbox-open-in-new-window",text:g.link.openInNewWindow,checked:!0}).render()).html()),h='<button href="#" class="btn btn-primary note-btn note-btn-primary note-link-btn disabled" disabled>'+g.link.insert+"</button>";this.$dialog=d.dialog({className:"link-dialog",title:g.link.insert,fade:f.dialogsFade,body:c,footer:h}).render().appendTo(b)},this.destroy=function(){d.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(a,b){a.on("keypress",function(a){a.keyCode===M.code.ENTER&&b.trigger("click")})},/**
     * toggle update button
     */
this.toggleLinkBtn=function(a,b,c){d.toggleBtn(a,b.val()&&c.val())},/**
     * Show link dialog and set event handlers on dialog controls.
     *
     * @param {Object} linkInfo
     * @return {Promise}
     */
this.showLinkDialog=function(e){return a.Deferred(function(a){var f=c.$dialog.find(".note-link-text"),g=c.$dialog.find(".note-link-url"),h=c.$dialog.find(".note-link-btn"),i=c.$dialog.find("input[type=checkbox]");d.onDialogShown(c.$dialog,function(){b.triggerEvent("dialog.shown"),
// if no url was given, copy text to url
e.url||(e.url=e.text),f.val(e.text);var j=function(){c.toggleLinkBtn(h,f,g),
// if linktext was modified by keyup,
// stop cloning text from linkUrl
e.text=f.val()};f.on("input",j).on("paste",function(){setTimeout(j,0)});var k=function(){c.toggleLinkBtn(h,f,g),
// display same link on `Text to display` input
// when create a new link
e.text||f.val(g.val())};g.on("input",k).on("paste",function(){setTimeout(k,0)}).val(e.url).trigger("focus"),c.toggleLinkBtn(h,f,g),c.bindEnterKey(g,h),c.bindEnterKey(f,h);var l=void 0!==e.isNewWindow?e.isNewWindow:b.options.linkTargetBlank;i.prop("checked",l),h.one("click",function(b){b.preventDefault(),a.resolve({range:e.range,url:g.val(),text:f.val(),isNewWindow:i.is(":checked")}),d.hideDialog(c.$dialog)})}),d.onDialogHidden(c.$dialog,function(){
// detach events
f.off("input paste keypress"),g.off("input paste keypress"),h.off("click"),"pending"===a.state()&&a.reject()}),d.showDialog(c.$dialog)}).promise()},/**
     * @param {Object} layoutInfo
     */
this.show=function(){var a=b.invoke("editor.getLinkInfo");b.invoke("editor.saveRange"),this.showLinkDialog(a).then(function(a){b.invoke("editor.restoreRange"),b.invoke("editor.createLink",a)}).fail(function(){b.invoke("editor.restoreRange")})},b.memo("help.linkDialog.show",f.langInfo.help["linkDialog.show"])},ja=function(b){var c=this,d=a.summernote.ui,e=b.options,f=b.layoutInfo.editor;this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){c.update()},"summernote.disable summernote.dialog.shown":function(){c.hide()}},this.shouldInitialize=function(){return!n.isEmpty(e.popover.link)},this.initialize=function(){var c=e.dialogsInBody?a(document.body):f;// digidesk: fix for popovers in body
this.$popover=d.popover({className:"note-link-popover",callback:function(a){var b=a.find(".popover-content,.note-popover-content");b.prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo(c);var g=this.$popover.find(".popover-content,.note-popover-content");b.invoke("buttons.build",g,e.popover.link)},this.destroy=function(){this.$popover.remove()},this.update=function(){
// Prevent focusing on editable when invoke('code') is executed
if(!b.invoke("editor.hasFocus"))return void this.hide();var c=b.invoke("editor.createRange");if(c.isCollapsed()&&c.isOnAnchor()){var d=q.ancestor(c.sc,q.isAnchor),e=a(d).attr("href");this.$popover.find("a").attr("href",e).html(e);var f=q.posFromPlaceholder(d);this.$popover.css({display:"block",left:f.left,top:f.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},ka=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.editor,f=b.options,g=f.langInfo;this.initialize=function(){var b=f.dialogsInBody?a(document.body):e,c="";if(f.maximumImageFileSize){var h=Math.floor(Math.log(f.maximumImageFileSize)/Math.log(1024)),i=1*(f.maximumImageFileSize/Math.pow(1024,h)).toFixed(2)+" "+" KMGTP"[h]+"B";c="<small>"+g.image.maximumFileSize+" : "+i+"</small>"}var j='<div class="form-group note-form-group note-group-select-from-files"><label class="note-form-label">'+g.image.selectFromFiles+'</label><input class="note-image-input form-control note-form-control note-input"  type="file" name="files" accept="image/*" multiple="multiple" />'+c+'</div><div class="form-group note-group-image-url" style="overflow:auto;"><label class="note-form-label">'+g.image.url+'</label><input class="note-image-url form-control note-form-control note-input  col-md-12" type="text" /></div>',k='<button href="#" class="btn btn-primary note-btn note-btn-primary note-image-btn disabled" disabled>'+g.image.insert+"</button>";this.$dialog=d.dialog({title:g.image.insert,fade:f.dialogsFade,body:j,footer:k}).render().appendTo(b)},this.destroy=function(){d.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(a,b){a.on("keypress",function(a){a.keyCode===M.code.ENTER&&b.trigger("click")})},this.show=function(){b.invoke("editor.saveRange"),this.showImageDialog().then(function(a){
// [workaround] hide dialog before restore range for IE range focus
d.hideDialog(c.$dialog),b.invoke("editor.restoreRange"),"string"==typeof a?// image url
b.invoke("editor.insertImage",a):// array of files
b.invoke("editor.insertImagesOrCallback",a)}).fail(function(){b.invoke("editor.restoreRange")})},/**
     * show image dialog
     *
     * @param {jQuery} $dialog
     * @return {Promise}
     */
this.showImageDialog=function(){return a.Deferred(function(a){var e=c.$dialog.find(".note-image-input"),f=c.$dialog.find(".note-image-url"),g=c.$dialog.find(".note-image-btn");d.onDialogShown(c.$dialog,function(){b.triggerEvent("dialog.shown"),
// Cloning imageInput to clear element.
e.replaceWith(e.clone().on("change",function(){a.resolve(this.files||this.value)}).val("")),g.click(function(b){b.preventDefault(),a.resolve(f.val())}),f.on("keyup paste",function(){var a=f.val();d.toggleBtn(g,a)}).val("").trigger("focus"),c.bindEnterKey(f,g)}),d.onDialogHidden(c.$dialog,function(){e.off("change"),f.off("keyup paste keypress"),g.off("click"),"pending"===a.state()&&a.reject()}),d.showDialog(c.$dialog)})}},la=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.editable,f=e[0],g=b.options,h=b.layoutInfo.editor;this.events={"summernote.disable":function(){c.hide()}},this.shouldInitialize=function(){return!n.isEmpty(g.popover.image)},this.initialize=function(){var c=g.dialogsInBody?a(document.body):h;// digidesk: fix for popovers in body
this.$popover=d.popover({className:"note-image-popover"}).render().appendTo(c);var e=this.$popover.find(".popover-content,.note-popover-content");b.invoke("buttons.build",e,g.popover.image)},this.destroy=function(){this.$popover.remove()},this.update=function(a){if(q.isImg(a)){var b=q.posFromPlaceholder(a),c=q.posFromPlaceholder(f);this.$popover.css({display:"block",left:b.left,top:Math.min(b.top,c.top)})}else this.hide()},this.hide=function(){this.$popover.hide()}},ma=function(b){var c=this,d=a.summernote.ui,e=b.options,f=b.layoutInfo.editor;this.events={"summernote.mousedown":function(a,b){c.update(b.target)},"summernote.keyup summernote.scroll summernote.change":function(){c.update()},"summernote.disable":function(){c.hide()}},this.shouldInitialize=function(){return!n.isEmpty(e.popover.table)},this.initialize=function(){var c=e.dialogsInBody?a(document.body):f;// digidesk: fix for popovers in body
this.$popover=d.popover({className:"note-table-popover"}).render().appendTo(c);var g=this.$popover.find(".popover-content,.note-popover-content");b.invoke("buttons.build",g,e.popover.table),
// [workaround] Disable Firefox's default table editor
l.isFF&&document.execCommand("enableInlineTableEditing",!1,!1)},this.destroy=function(){this.$popover.remove()},this.update=function(a){if(b.isDisabled())return!1;var c=q.isCell(a);if(c){var d=q.posFromPlaceholder(a);this.$popover.css({display:"block",left:d.left,top:d.top})}else this.hide();return c},this.hide=function(){this.$popover.hide()}},na=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.editor,f=b.options,g=f.langInfo;this.initialize=function(){var b=f.dialogsInBody?a(document.body):e,c='<div class="form-group note-form-group row-fluid"><label class="note-form-label">'+g.video.url+' <small class="text-muted">'+g.video.providers+'</small></label><input class="note-video-url form-control  note-form-control note-input span12"  type="text" /></div>',h='<button href="#" class="btn btn-primary note-btn note-btn-primary  note-video-btn disabled" disabled>'+g.video.insert+"</button>";this.$dialog=d.dialog({title:g.video.insert,fade:f.dialogsFade,body:c,footer:h}).render().appendTo(b)},this.destroy=function(){d.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(a,b){a.on("keypress",function(a){a.keyCode===M.code.ENTER&&b.trigger("click")})},this.createVideoNode=function(b){
// video url patterns(youtube, instagram, vimeo, dailymotion, youku, mp4, ogg, webm)
var c,d=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,e=b.match(d),f=/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/,g=b.match(f),h=/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/,i=b.match(h),j=/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/,k=b.match(j),l=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,m=b.match(l),n=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,o=b.match(n),p=/\/\/v\.qq\.com.*?vid=(.+)/,q=b.match(p),r=/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/,s=b.match(r),t=/^.+.(mp4|m4v)$/,u=b.match(t),v=/^.+.(ogg|ogv)$/,w=b.match(v),x=/^.+.(webm)$/,y=b.match(x);if(e&&11===e[1].length){var z=e[1];c=a("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+z).attr("width","640").attr("height","360")}else if(g&&g[0].length)c=a("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+g[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(i&&i[0].length)c=a("<iframe>").attr("frameborder",0).attr("src",i[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(k&&k[3].length)c=a("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+k[3]).attr("width","640").attr("height","360");else if(m&&m[2].length)c=a("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+m[2]).attr("width","640").attr("height","360");else if(o&&o[1].length)c=a("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+o[1]);else if(q&&q[1].length||s&&s[2].length){var A=q&&q[1].length?q[1]:s[2];c=a("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","http://v.qq.com/iframe/player.html?vid="+A+"&amp;auto=0")}else{if(!(u||w||y))
// this is not a known video link. Now what, Cat? Now what?
return!1;c=a("<video controls>").attr("src",b).attr("width","640").attr("height","360")}return c.addClass("note-video-clip"),c[0]},this.show=function(){var a=b.invoke("editor.getSelectedText");b.invoke("editor.saveRange"),this.showVideoDialog(a).then(function(a){
// [workaround] hide dialog before restore range for IE range focus
d.hideDialog(c.$dialog),b.invoke("editor.restoreRange");
// build node
var e=c.createVideoNode(a);e&&
// insert video node
b.invoke("editor.insertNode",e)}).fail(function(){b.invoke("editor.restoreRange")})},/**
     * show image dialog
     *
     * @param {jQuery} $dialog
     * @return {Promise}
     */
this.showVideoDialog=function(e){return a.Deferred(function(a){var f=c.$dialog.find(".note-video-url"),g=c.$dialog.find(".note-video-btn");d.onDialogShown(c.$dialog,function(){b.triggerEvent("dialog.shown"),f.val(e).on("input",function(){d.toggleBtn(g,f.val())}).trigger("focus"),g.click(function(b){b.preventDefault(),a.resolve(f.val())}),c.bindEnterKey(f,g)}),d.onDialogHidden(c.$dialog,function(){f.off("input"),g.off("click"),"pending"===a.state()&&a.reject()}),d.showDialog(c.$dialog)})}},oa=function(b){var c=this,d=a.summernote.ui,e=b.layoutInfo.editor,f=b.options,g=f.langInfo;this.createShortCutList=function(){var c=f.keyMap[l.isMac?"mac":"pc"];return Object.keys(c).map(function(d){var e=c[d],f=a('<div><div class="help-list-item"/></div>');return f.append(a("<label><kbd>"+d+"</kdb></label>").css({width:180,"margin-right":10})).append(a("<span/>").html(b.memo("help."+e)||e)),f.html()}).join("")},this.initialize=function(){var b=f.dialogsInBody?a(document.body):e,c=['<p class="text-center">','<a href="http://summernote.org/" target="_blank">Summernote 0.8.8</a> · ','<a href="https://github.com/summernote/summernote" target="_blank">Project</a> · ','<a href="https://github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=d.dialog({title:g.options.help,fade:f.dialogsFade,body:this.createShortCutList(),footer:c,callback:function(a){a.find(".modal-body,.note-modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(b)},this.destroy=function(){d.hideDialog(this.$dialog),this.$dialog.remove()},/**
     * show help dialog
     *
     * @return {Promise}
     */
this.showHelpDialog=function(){return a.Deferred(function(a){d.onDialogShown(c.$dialog,function(){b.triggerEvent("dialog.shown"),a.resolve()}),d.showDialog(c.$dialog)}).promise()},this.show=function(){b.invoke("editor.saveRange"),this.showHelpDialog().then(function(){b.invoke("editor.restoreRange")})}},pa=function(b){var c=this,d=a.summernote.ui,e=b.options,f=20;this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){c.update()},"summernote.disable summernote.change summernote.dialog.shown":function(){c.hide()},"summernote.focusout":function(a,b){
// [workaround] Firefox doesn't support relatedTarget on focusout
//  - Ignore hide action on focus out in FF.
l.isFF||b.relatedTarget&&q.ancestor(b.relatedTarget,m.eq(c.$popover[0]))||c.hide()}},this.shouldInitialize=function(){return e.airMode&&!n.isEmpty(e.popover.air)},this.initialize=function(){this.$popover=d.popover({className:"note-air-popover"}).render().appendTo("body");var a=this.$popover.find(".popover-content");b.invoke("buttons.build",a,e.popover.air)},this.destroy=function(){this.$popover.remove()},this.update=function(){var a=b.invoke("editor.currentStyle");if(a.range&&!a.range.isCollapsed()){var c=n.last(a.range.getClientRects());if(c){var d=m.rect2bnd(c);this.$popover.css({display:"block",left:Math.max(d.left+d.width/2,0)-f,top:d.top+d.height}),b.invoke("buttons.updateCurrentStyle",this.$popover)}}else this.hide()},this.hide=function(){this.$popover.hide()}},qa=function(b){var c=this,d=a.summernote.ui,e=5,f=b.options.hint||[],g=b.options.hintDirection||"bottom",h=a.isArray(f)?f:[f],i=b.options,j=b.layoutInfo.editor;this.events={"summernote.keyup":function(a,b){b.isDefaultPrevented()||c.handleKeyup(b)},"summernote.keydown":function(a,b){c.handleKeydown(b)},"summernote.disable summernote.dialog.shown":function(){c.hide()}},this.shouldInitialize=function(){return h.length>0},this.initialize=function(){var b=i.dialogsInBody?a(document.body):j;// digidesk: fix for popovers in body
this.lastWordRange=null,this.$popover=d.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo(b),this.$popover.hide(),this.$content=this.$popover.find(".popover-content,.note-popover-content"),this.$content.on("click",".note-hint-item",function(){c.$content.find(".active").removeClass("active"),a(this).addClass("active"),c.replace()})},this.destroy=function(){this.$popover.remove()},this.selectItem=function(a){this.$content.find(".active").removeClass("active"),a.addClass("active"),this.$content[0].scrollTop=a[0].offsetTop-this.$content.innerHeight()/2},this.moveDown=function(){var a=this.$content.find(".note-hint-item.active"),b=a.next();if(b.length)this.selectItem(b);else{var c=a.parent().next();c.length||(c=this.$content.find(".note-hint-group").first()),this.selectItem(c.find(".note-hint-item").first())}},this.moveUp=function(){var a=this.$content.find(".note-hint-item.active"),b=a.prev();if(b.length)this.selectItem(b);else{var c=a.parent().prev();c.length||(c=this.$content.find(".note-hint-group").last()),this.selectItem(c.find(".note-hint-item").last())}},this.replace=function(){var a=this.$content.find(".note-hint-item.active");if(a.length){var c=this.nodeFromItem(a);
// XXX: consider to move codes to editor for recording redo/undo.
this.lastWordRange.insertNode(c),N.createFromNode(c).collapse().select(),this.lastWordRange=null,this.hide(),b.triggerEvent("change",b.layoutInfo.editable.html(),b.layoutInfo.editable),b.invoke("editor.focus")}},this.nodeFromItem=function(a){var b=h[a.data("index")],c=a.data("item"),d=b.content?b.content(c):c;return"string"==typeof d&&(d=q.createText(d)),d},this.createItemTemplates=function(b,c){var d=h[b];return c.map(function(c,e){var f=a('<div class="note-hint-item"/>');return f.append(d.template?d.template(c):c+""),f.data({index:b,item:c}),0===b&&0===e&&f.addClass("active"),f})},this.handleKeydown=function(a){this.$popover.is(":visible")&&(a.keyCode===M.code.ENTER?(a.preventDefault(),this.replace()):a.keyCode===M.code.UP?(a.preventDefault(),this.moveUp()):a.keyCode===M.code.DOWN&&(a.preventDefault(),this.moveDown()))},this.searchKeyword=function(a,b,c){var d=h[a];if(d&&d.match.test(b)&&d.search){var e=d.match.exec(b);d.search(e[1],c)}else c()},this.createGroup=function(b,d){var e=a('<div class="note-hint-group note-hint-group-'+b+'"/>');return this.searchKeyword(b,d,function(a){a=a||[],a.length&&(e.html(c.createItemTemplates(b,a)),c.show())}),e},this.handleKeyup=function(a){if(n.contains([M.code.ENTER,M.code.UP,M.code.DOWN],a.keyCode)){if(a.keyCode===M.code.ENTER&&this.$popover.is(":visible"))return}else{var d=b.invoke("editor.createRange").getWordRange(),f=d.toString();if(h.length&&f){this.$content.empty();var i=m.rect2bnd(n.last(d.getClientRects()));i&&(this.$popover.hide(),this.lastWordRange=d,h.forEach(function(a,b){a.match.test(f)&&c.createGroup(b,f).appendTo(c.$content)}),
// set position for popover after group is created
"top"===g?this.$popover.css({left:i.left,top:i.top-this.$popover.outerHeight()-e}):this.$popover.css({left:i.left,top:i.top+i.height+e}))}else this.hide()}},this.show=function(){this.$popover.show()},this.hide=function(){this.$popover.hide()}};a.summernote=a.extend(a.summernote,{version:"0.8.8",ui:L,dom:q,plugins:{},options:{modules:{editor:X,clipboard:Y,dropzone:Z,codeview:$,statusbar:aa,fullscreen:ba,handle:ca,
// FIXME: HintPopover must be front of autolink
//  - Script error about range when Enter key is pressed on hint popover
hintPopover:qa,autoLink:da,autoSync:ea,placeholder:fa,buttons:ga,toolbar:ha,linkDialog:ia,linkPopover:ja,imageDialog:ka,imagePopover:la,tablePopover:ma,videoDialog:na,helpDialog:oa,airPopover:pa},buttons:{},lang:"en-US",
// toolbar
toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],
// popover
popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},
// air mode: inline editor
airMode:!1,width:null,height:null,linkTargetBlank:!0,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,direction:null,tooltip:"auto",styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],
// pallete colors(n x n)
colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",rowBelow:"note-icon-row-below",colBefore:"note-icon-col-before",colAfter:"note-icon-col-after",rowAbove:"note-icon-row-above",rowRemove:"note-icon-row-remove",colRemove:"note-icon-col-remove",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-menu-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})}),function(a){a.extend(a.summernote.plugins,{ddmedia:function(b){var c=b.layoutInfo,d=c.toolbar,e=a.summernote.ui;this.initialize=function(){
// create button
var c=e.button({className:"btn-default",contents:'<i class="fa fa-file-image-o"></i>',click:function(a){"undefined"==typeof MediaLibrary?top.basefrm&&top.basefrm.OverlayInstance&&top.basefrm.OverlayInstance.showOverlay(b):MediaLibrary.open(/image\/.*/i,function(a,c,d){b.invoke("editor.insertImage",d,function(a){a.css("max-width","100%"),a.attr("data-filename",c),a.attr("data-filepath",d),a.attr("data-source","media"),a.addClass("dd-wysiwyg-media-image")})})}});
// generate jQuery element from button instance.
this.$button=c.render(),d.find(".note-btn-group.note-insert").length?d.find(".note-btn-group.note-insert").append(this.$button):d.append(a('<div class="note-btn-group btn-group" />').append(this.$button))},this.destroy=function(){this.$button.remove(),this.$button=null}}})}(jQuery),function(a){"use strict";var b=function(a){return a&&"TEXTAREA"===a.nodeName.toUpperCase()};a.extend(a.summernote.dom,{value:function(a,c){var d;
// fix smarty tags within attributes
// switch smarty function call with media url
return b(a[0])?(d=a.val(),d=d.replace(/(=\s*")([^">]*)(\[\{([^\}\]]|\}[^\]]|[^\}]\])*\}\])([^">]*)(")/gi,function(a,b,c,d,e,f,g){return d=d.replace(/\\"/g,"'").replace(/"/g,"'"),b+c+d+f+g}),d=d.replace(/<img[^>]*src=\s*"(\[\{\$oViewConf\-\>getMediaUrl\(\)\}\][^">]+)"[^>]*data-filepath=\s*"([^">]+)"[^>]*class=\s*"[^">]*dd-wysiwyg-media-image[^">]*"[^>]*>/gi,function(a,b,c){return a=a.replace(b,c)})):d=a.html(),c?d.replace(/[\n\r]/g,""):d},html:function(b,c){var d=this.value(b);if(c){var e=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;d=d.replace(e,function(a,b,c){c=c.toUpperCase();var d=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(c)&&!!b,e=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(c);return a+(d||e?"\n":"")}),d=a.trim(d)}
// set media smarty tags
// replace html entities in smarty tags
return d=d.replace(/<img[^>]*src=\s*"([^"]+)"[^>]*data-filename=\s*"([^">]+)"[^>]*class=\s*"[^">]*dd-wysiwyg-media-image[^">]*"[^>]*>/gi,function(a,b,c){return a.replace(b,"[{$oViewConf->getMediaUrl()}]"+c)}),d=d.replace(/\[\{(([^\}\]]|\}[^\]]|[^\}]\])*)\}\]/gi,function(b,c,d){return a("<textarea />").html(b).text()})}})}(jQuery),function(a){"use strict";var b=function(a){return a&&"TEXTAREA"===a.nodeName.toUpperCase()};a.extend(a.summernote.dom,{value:function(a){var c;
// filter cross-site scripts from code view
return b(a[0])?(c=a.val(),c=c.replace(/<\/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|ilayer|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|t(?:itle|extarea)|xml)[^>]*?>/gim,"")):c=a.html(),c},html:function(b){var c=this.value(b);
// filter cross-site scripts from code view
return c=c.replace(/<\/*(?:applet|b(?:ase|gsound|link)|embed|frame(?:set)?|ilayer|l(?:ayer|ink)|meta|object|s(?:cript|tyle)|t(?:itle|extarea)|xml)[^>]*?>/gim,""),c=a.trim(c)}})}(jQuery),/**
 * This file is part of OXID eSales WYSIWYG module.
 *
 * OXID eSales WYSIWYG module is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * OXID eSales WYSIWYG module is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with OXID eSales WYSIWYG module.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @link      http://www.oxid-esales.com
 * @copyright (C) OXID eSales AG 2003-2017
 * @version   OXID eSales WYSIWYG
 */
$.noConflict(),+function(a){"use strict";var b=a.fn.tooltip;a.fn.tooltip=function(a){return"undefined"!=typeof a&&(a.container="#ddoew"),b.call(this,a)},a(function(){
// Summernote WYSIWYG Editor
if("function"==typeof a().summernote){a(".ddoe-wysiwyg-editor > textarea").each(function(){var b=a(this).attr("data-rte");if("undefined"==typeof b){a(this).attr("data-rte","1"),a(this).closest("td").find(".messagebox").remove();var c=a(this).height(),d=a(this).summernote({lang:"de-DE",minHeight:c||100,toolbar:[["style",["style"]],["formatting",["bold","italic","underline","strikethrough","clear"]],
//[ 'fontname', [ 'fontname' ] ],
["fontsize",["fontsize"]],["color",["color"]],["layout",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","video","hr"]],["misc",["codeview"]]],dialogsInBody:!1,buttons:{ddmedia:"ddmedia"},disableDragAndDrop:!0});"disabled"===a(this).attr("disabled")&&a(this).summernote("disable");var e=d.data("summernote");e.invoke("codeview.activate"),e.invoke("codeview.deactivate")}});var b=a(".ddoe-wysiwyg-editor").first().closest("form");b.find('*[type="submit"]').first().on("click",function(){a(".ddoe-wysiwyg-editor > textarea",b).each(function(){var b=a(this).data("summernote");
// deactivate codeview before getting value
b.invoke("codeview.isActivated")&&b.invoke("codeview.deactivate"),b.invoke("codeview.activate");
// replace incorrectly encoded html lace bracket in smarty tags
var c=a(this).summernote("code");c=c.replace(/\[\{(([^\}\]]|\}[^\]]|[^\}]\])*)\}\]/gi,function(a){return a.replace(/-&gt;/g,"->")}),a(this).summernote("code",c)})})}})}(jQuery);
//# sourceMappingURL=backend.min.js.map